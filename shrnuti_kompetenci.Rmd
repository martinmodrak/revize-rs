---
title: "Shrnutí kompetencí"
toc-title: "Obsah"
abstract: "Tento dokument podává základní přehled o odpovědích na kompetenční otázky."
output:
  word_document:
    toc: yes
    reference_docx: public_data/output_template.docx
---


```{r setup, message=FALSE,warning=FALSE, results="hide", echo = FALSE}
source(here::here("R","setup_dotaznik.R"), encoding = "UTF-8")
knitr::opts_chunk$set(echo = FALSE)
```

```{r nacist_data, cache=TRUE}
source(here::here("R","datasety_dotaznik.R"), encoding = "UTF-8")

plots <- list() 
```

# Na co jsme se přesně ptali?

```{r}
otazky_rmd <- kompetence_otazky %>% arrange(ciselne_id) %>% mutate(rmd = paste0("- **", popis_pro_grafy,"** (",nazev_oblasti," - ", nazev_podoblasti,")\r\n  - ", text_otazky)) %>% pull(rmd) %>% paste0(collapse = "\r\n") 
```

Tučně je zkrácený popis, který budeme používat v tabulkách a grafech, za ním v závorce odkaz, jak je tato kompetence uvedena mezi "komptencemi skautské výchovy", pod tím přesné znění otázky, jak bylo v dotazníku.

`r otazky_rmd`

Ke každé kompetenci jsme měli 4 otázky (kategorie):

- Zvládám/ovládám to výborně.
- Je to pro mě velmi důležité.
- Rozvíjím se v tom.
- Skauting mi v rozvoji významně pomáhá.

Ke každé otázce vybírali odpověď na sedmibodové škále od "Zcela souhlasím" po "Zcela nesouhlasím".

Část respondentů měla kratší verzi dotazníku a vyjadřovala se tak jen k náhodně vybrané polovině otázek.

# Dle kategorie

Zde si shrneme celkové odpovědi ke každé kategorii.

## Zvládám

```{r}
plot_kategorie_kompetence <- function(data_long, kategorie, kategorie_popis) {
  data_to_plot <- data_long %>% 
    filter(kategorie_kompetence == kategorie, !is.na(kompetence_odpoved)) %>%
    group_by(kompetence_odpoved) %>%
    summarise(pocet = n()) %>% 
    ungroup() %>%
    mutate(podil = pocet / sum(pocet))

  data_to_plot %>% 
    ggplot(aes(x = kompetence_odpoved, y = podil, label = scales::percent(podil, accuracy = 1))) +
      geom_bar(stat = "identity") +
      geom_text(nudge_y = 0.03, size = 7) +
      scale_x_continuous(breaks = c(1,4,7), labels = c("Zcela nesouhlasím", "Neutrální", "Zcela souhlasím")) +
      theme(axis.title = element_blank(), axis.line.y = element_blank(), axis.title.y = element_blank(), axis.ticks.y = element_blank(), axis.text.y = element_blank()) + ggtitle(paste0('Celkové rozložení odpovědí\n"', kategorie_popis,'"')) + vodorovne_popisky_x
}

plots$zvladam_celkem <-  plot_kategorie_kompetence(hlavni_data_long, "zvladam", popis_pro_plot(hlavni_data, "duchovni_zivot.zvladam"))
plots$zvladam_celkem
```

Je spíš situace taková, že každý má nějakou slabou stránku, nebo spíš máme lidi, co všechno zvládají a lidi, co nic nezvládají? (zde nezvládám = sloučené všechny tři negativní odpovědi)

```{r}
data_nezvladam <- hlavni_data_long %>% filter(kategorie_kompetence == "zvladam") %>% 
  group_by(session) %>%
  summarise(pocet_nezvladam = sum(kompetence_odpoved <= 3), podil_nezvladam = mean(kompetence_odpoved <= 3), prumer_zvladam = mean(kompetence_odpoved)) %>%
  ungroup()

data_nezvladam %>%
  mutate(pocet_nezvladam = if_else(pocet_nezvladam < 7, as.character(pocet_nezvladam), "7 a více")) %>%
  group_by(pocet_nezvladam) %>%
  summarise(pocet_respondentu = n()) %>% table_format()
```

Jiný pohled na podobnou věc - když odpovědi převedeme na čísla 1-7 a zprůměrujeme za každého respondenta, jak to bude vypadat?

```{r}
data_nezvladam %>% ggplot(aes(x = prumer_zvladam)) + geom_histogram(binwidth = 0.5) + vodorovne_popisky_x + plot_annotation("Průměr hodnocení Zvládám","histogram průměru jednotlivých respondentů")
```


Které kompetence jsou nejčastěji nezvládané? Abychom se vyhnuli problémům s tím, že různí lidé mají různě kalibrovanou stupnici, podíváme se, jak často je daná kompetence pro respodenta nejhorší, tj. dostala nejnižší hodnocení ze všech (pokud je jich takových více, počítáme všechny). Žebříček se ale změní jen málo, když se podíváme na průměrné hodnocení napříč všemi respondenty nebo podíl těch, kteří vybrali jednu ze tří negativních odpovědí.

```{r}
tabulka_nezvladane <- hlavni_data_long %>% filter(kategorie_kompetence == "zvladam") %>% 
  group_by(popis_pro_grafy) %>% 
  summarise(pocet_nezvladam = sum(kompetence_nejnize), pocet_celkem = n(), podil = pocet_nezvladam/pocet_celkem) %>%
  ungroup() %>%
  arrange(desc(pocet_nezvladam)) %>%
  rename(kompetence = popis_pro_grafy)

tabulka_nezvladane %>% mutate(podil_nezvladam = scales::percent(podil)) %>% table_format()

plot_tabulka_extrem <- function(tabulka, indices = 5:1, text_y = 0.02) {
  tabulka[indices, ] %>% 
    mutate(kompetence = factor(kompetence, levels = kompetence)) %>% ggplot(aes(x = kompetence, y = podil, label = scales::percent(podil, accuracy = 1))) + geom_bar(stat = "identity") + coord_flip() + geom_text(y = text_y, size = 6, color = revize_cols("dark_blue")) + theme(axis.title = element_blank(), axis.ticks.x = element_blank(), axis.text.x =  element_blank())
}

plots$top_nezvladane <- plot_tabulka_extrem(tabulka_nezvladane) + plot_annotation("Nejčastěji nezvládané kompetence", subtitle = "Jak často je daná kompetence u respondenta 'nejhorší'")
plots$top_nezvladane
```

## Důležité

A nyní to samé pro "Je to pro mě velmi důležité" - zde je vidět, že respondenti považují v podstatě vše za důležité a spektrum odpovědí je tak na rozdíl od ostatních otázek posunuté hodně "doprava".

```{r}
plots$dulezite_celkem <- plot_kategorie_kompetence(hlavni_data_long, "dulezite", popis_pro_plot(hlavni_data, "duchovni_zivot.dulezite"))
plots$dulezite_celkem
```


```{r}
data_nedulezite <- hlavni_data_long %>% filter(kategorie_kompetence == "dulezite") %>% 
  group_by(session) %>%
  summarise(pocet_nedulezite = sum(kompetence_odpoved <= 3), podil_nedulezite = mean(kompetence_odpoved <= 3), prumer_dulezite = mean(kompetence_odpoved)) %>%
  ungroup()

data_nedulezite %>%
  mutate(pocet_nedulezite = if_else(pocet_nedulezite < 5, as.character(pocet_nedulezite), "5 a více")) %>%
  group_by(pocet_nedulezite) %>%
  summarise(pocet_respondentu = n()) %>% table_format()
```


```{r}
data_nedulezite %>% ggplot(aes(x = prumer_dulezite)) + geom_histogram(binwidth = 0.5) + vodorovne_popisky_x + plot_annotation("Průměr hodnocení Důležité","histogram průměru jednotlivých respondentů")
```



Které kompetence jsou nejčastěji nedůležité? Opět se díváme na to, kdy je komptence hodnocena respondentem jako nejméně důležitá ze všech, které vyplnil a opět se pořadí změní jen málo když použijeme jiné měřítko.

```{r}
tabulka_nedulezite <- hlavni_data_long %>% filter(kategorie_kompetence == "dulezite") %>% 
  group_by(popis_pro_grafy) %>% 
  summarise(pocet_nedulezite = sum(kompetence_nejnize), podil = mean(kompetence_nejnize), podil_nedulezite = scales::percent(podil)) %>%
  arrange(desc(pocet_nedulezite)) %>%
  rename(kompetence = popis_pro_grafy)


tabulka_nedulezite %>% select(-podil) %>% table_format()

plots$top_nedulezite <- plot_tabulka_extrem(tabulka_nedulezite) + plot_annotation("Nejčastěji nedůležité kompetence", subtitle = "Jak často je daná kompetence u respondenta 'nejhorší'")
plots$top_nedulezite
```

Pro kontrolu: pohled z druhé strany (jak často je daná kompetence hodnocena "nejvýše") nám dá celkem podobné výsledky jako obrácení předchozího žebříčku, ač třeba "4,A Rodina" je v předchozí tabulce zhruba v půlce a zde se dostane na třetí místo. Nutno říct, že vzhledem k celkově vysokým odpovědím jde v podstatě o to, jak často dostala daná kompetence u "Je to pro mě velmi důležité" odpověď "Zcela souhlasím". 

```{r}
tabulka_dulezite <- hlavni_data_long %>% filter(kategorie_kompetence == "dulezite") %>% 
  group_by(popis_pro_grafy) %>% 
  summarise(pocet_dulezite = sum(kompetence_nejvyse), podil = mean(kompetence_nejvyse), podil_dulezite = scales::percent(podil)) %>%
  arrange(desc(pocet_dulezite)) %>%
  rename(kompetence = popis_pro_grafy)

plots$top_dulezite <- plot_tabulka_extrem(tabulka_dulezite, text_y = 0.05) + plot_annotation("Nejčastěji důležité kompetence", subtitle = "Jak často je u respondenta 'nejlepší'")
plots$top_dulezite

```



## Rozvíjím se v tom

A ještě obdobné grafy pro "Rozvíjím se v tom"

```{r}
plots$rozvijim_celkem <- plot_kategorie_kompetence(hlavni_data_long, "rozvijim", popis_pro_plot(hlavni_data, "duchovni_zivot.rozvijim"))
plots$rozvijim_celkem

```

V tabulce opět počet co odpověděli jednou ze tří negativních odpovědí. Velká část respondentů neměla ani jednu komptenci, kde si myslí, že se spíše nerozvíjí.

```{r}
data_nerozvijim <- hlavni_data_long %>% filter(kategorie_kompetence == "rozvijim") %>% 
  group_by(session) %>%
  summarise(pocet_nerozvijim = sum(kompetence_odpoved <= 3), podil_nerozvijim = mean(kompetence_odpoved <= 3), prumer_rozvijim = mean(kompetence_odpoved)) %>%
  ungroup()

data_nerozvijim %>%
  mutate(pocet_nerozvijim = if_else(pocet_nerozvijim < 7, as.character(pocet_nerozvijim), "7 a více")) %>%
  group_by(pocet_nerozvijim) %>%
  summarise(pocet_respondentu = n()) %>% table_format()
```


```{r}
data_nerozvijim %>% ggplot(aes(x = prumer_rozvijim)) + geom_histogram(binwidth = 0.5) + vodorovne_popisky_x  + plot_annotation("Průměr hodnocení Rozvíjím se v tom","histogram průměru jednotlivých respondentů")
```

Které kompetence se nejčastěji nerozvíjí? (tedy jsou hodnoceny nejníže pro každého respondenta). Opět se pořadí mění jen málo, vezmeme-li jiné měřítko.

```{r}
tabulka_nerozvijim <- hlavni_data_long %>% filter(kategorie_kompetence == "rozvijim") %>% 
  group_by(popis_pro_grafy) %>% 
  summarise(pocet_nerozvijim = sum(kompetence_nejnize), podil = mean(kompetence_nejnize), podil_nerozvijim = scales::percent(podil)) %>%
  arrange(desc(pocet_nerozvijim)) %>%
  rename(kompetence = popis_pro_grafy) 

tabulka_nerozvijim %>% select(-podil) %>% table_format()

plots$top_nerozvijim <- plot_tabulka_extrem(tabulka_nerozvijim) + plot_annotation("Nejčastěji nerozvíjené kompetence", subtitle = "Jak často je daná kompetence u respondenta 'nejhorší'")
plots$top_nerozvijim

```


## Skauting mi pomáhá

```{r}
plots$skauting_celkem <- plot_kategorie_kompetence(hlavni_data_long, "skauting", popis_pro_plot(hlavni_data, "duchovni_zivot.skauting")) + theme(plot.title = element_text(size = 30))
plots$skauting_celkem

```

Opět je hodně lidí, kteří nemají žádnou kompetenci u které by odpověděli "Spíše nesouhlasím" a hůř na otázku "Skauting mi v rozvoji významně pomáhá".

```{r}
data_neskauting <- hlavni_data_long %>% filter(kategorie_kompetence == "skauting") %>% 
  group_by(session) %>%
  summarise(pocet_neskauting = sum(kompetence_odpoved <= 3), podil_neskauting = mean(kompetence_odpoved <= 3), prumer_skauting = mean(kompetence_odpoved)) %>%
  ungroup()

data_neskauting %>%
  mutate(pocet_neskauting = if_else(pocet_neskauting < 5, as.character(pocet_neskauting), "5 a více")) %>%
  group_by(pocet_neskauting) %>%
  summarise(pocet_respondentu = n()) %>% table_format()
```


```{r}
data_neskauting %>% ggplot(aes(x = prumer_skauting)) + geom_histogram(binwidth = 0.5) + vodorovne_popisky_x  + plot_annotation("Průměr hodnocení Skauting mi pomáhí","histogram průměru jednotlivých respondentů")
```

Které kompetence skauting nejčastěji míjí? (opět zde jak často je kompetence nejhůře hodnocena, opět se málo změní s jiným měřítkem toho, co znamená "špatně zhodnocena").

To, že kompetence rodina není považovaná za rozvíjenou skautingem asi nepřekvapí, ale aktivní občasntví, duchovní život, svědomí nebo sebepoznání jsou věci, kde má skauting unikátní postavení.


```{r}
tabulka_neskauting <- hlavni_data_long %>% filter(kategorie_kompetence == "skauting") %>% 
  group_by(popis_pro_grafy) %>% 
  summarise(pocet_neskauting = sum(kompetence_nejnize), podil = mean(kompetence_nejnize), podil_neskauting = scales::percent(podil)) %>%
  arrange(desc(pocet_neskauting)) %>%
  rename(kompetence = popis_pro_grafy)

tabulka_neskauting

plots$top_neskauting <- plot_tabulka_extrem(tabulka_neskauting, text_y = 0.05) + plot_annotation("Skautingem nejčastěji nerozvíjené", subtitle = "Jak často je daná kompetence u respondenta 'nejhorší'")
plots$top_neskauting
```


# Vývoj s věkem

Pro jednoduchost interpretace zde budeme převádět odpovědi respondentů na čísla 1-7 a dívat se na průměr z těchto čísel. To není úplně ideální způsob, jak pracovat s tímto druhem dat, ale má tu výhodu, že je snadné výsledek interpretovat. Zároveň se trendy nezmění, když použijeme nějaké vhodnější měřítko.

**Zásadní poznámka k interpretaci:** Z dat, které máme _nelze_ rozlišit dva možné původce rozdílných odpovědí dle věku: vlastní efekt stárnutí a tzv. _kohortový_ efekt, tj. vliv toho, že lidé, kterým je dnes 25 vyrůstali v jiné době a jiném kontextu (i skautském) než lidé, kterým je dnes 15 - a proto mohou mít jiné hodnoty, jinou míru sebereflexe (nebo jiný důvod, proč se vůbec dostali k našemu dotazníku). Pokud bychom tyto vlivy chtěli rozlišit, museli bychom výzkum ještě někdy zopakovat.


## Zvládám to

Nejdříve se podíváme na průměr hodnocení "Zvládám" napříč všemi kompetencemi dle věku - je zde spíše vzestupný trend s několika zuby - ty jsou (jak uvidíme za chvíli) primárně způsobeny podivnou fluktuací v kompetenci "3.A Kamarádské vztahy". Vzestupný trend může být způsoben rozvojem v roverském věku, změnou sebehdnocení s věkem nebo tím, že ta dnešní mladá generace zvládá všechno hůř než my v jejich věku ;-). Taky je dobré si všimnout, že celý graf pokrývá jen několik desetin jednoho bodu, tj. díky velkému počtu respondentů zde máme malou nejistotu (světlý pruh), ale absolutní velikost změn je malá.

```{r}
plot_kompetence_by(hlavni_data_long, "zvladam", age, all_together = TRUE)
```

Můžeme se podívat též na trendy pro jednotlivé kompetence - a to přímo tak, jak jsou v datech nebo mírně vyhlazené, kde jsou patrné celkové trendy. Většina kompetencí je s přibývajícím věkem hodnocena výše (v souladu s celkovým trendem z předchozího obrázku), některé zhruba setrvaly. Výjimku tvoří klesající "1.B Fyzicky zdatný" (kde pokles s věkem nepřekvapí a asi nikdo netvrdí, že současná mladá generace se hýbe více než její předchůdci) a "6.E Šetrnost" (kde může alespoň částečně jít o směs změny sebehodnocení nebo kohortový efekt). Komplikovanější trend je pak u "2.C Rozvoj osobnosti", "3.A Kamarádské vztahy" a "4.A Rodina". Lze tu trochu spekulovat o vlivu životních změn (vysoká škola, práce), ale ruku do ohně bych za to nedal.

Je taky dobré si všimnout, že průměrné sebehodnocení kompetenci se zřídka liší mezi mladšími a staršími o více jak půl stupně. Nejvýraznější změna je u "3.A Kamarádské vztahy" - díky tomu, že ostatní kompetence se trochu "vyprůměrují", je tato fluktuace promítnuta i do celkového průměru.

```{r}
plot_kompetence_by(hlavni_data_long, "zvladam", age)
plots$zvladam_age_smooth <- plot_kompetence_by_smooth(hlavni_data_long, "zvladam", age)
plots$zvladam_age_smooth
```

## Je to pro mě důležité

Obdobně průměrné hodnocení důležitosti. Při pohledu na celkový průměr vidíme podivné zuby, které je těžké interpetovat (tentokrát je nelze snadno svést na jednu kompetenci). Zároveň zde není znatelný celkový vzestupný nebo sestupný trend. Opět si všimněte, že největší skok (mezi 22. a 23. rokem) je 0.2 stupně, tj. velmi málo.

```{r}
plot_kompetence_by(hlavni_data_long, "dulezite", age, all_together = TRUE)
```

Trendy pro jednotlivé kompetence jsou v něčem hezké - klesá vnímaná důležitost "technických" kompetencí ("1.E Táboření, tým", "1.F Tvořivost, zručnost","6.E Šetrnost") a mírně roste důležitost duchovních kompetencí ("2.A1 Hledání smyslu života", "2.B1 Svědomí", "2.B2 Slib, zákon"). Pokud to je sktučeně efekt stárnutí a zrání, je to dle mého super. Pokud je to kohortový efekt (tj. že dříve se v oddílech kladl větší důraz na hodnoty než dnes a to si roveři už nesou celý život), tak je to smutné.

Opět zdůrazním, že změny v průměrném sebehodnocení jsou mírné - většinou o max. půl stupně ze sedmi.

```{r}
plot_kompetence_by(hlavni_data_long, "dulezite", age)
plots$dulezite_age_smooth <-  plot_kompetence_by_smooth(hlavni_data_long, "dulezite", age)
plots$dulezite_age_smooth
```



## Rozvijim se v tom

Celkový trend vnímání seberozvoje je klesající a to (s ohledem na předchozí otázky) poměrně výrazně - o zhruba půl stupně. Optimistický výklad je, že jde o výsledek toho, že roveři věci čím dál lépe zvládají, pesimistický že s věkem leniví a kornatí. Je taky možné, že jde jen o střízlivější sebehodnocení u starších nebo čistě o kohortový efekt, kdy současní mladí prožívají více rozvoje, protože se změnila situace ve společnosti a skautingu, ne proto, že jsou mladší. Opět neumím vysvětlit zub mezi 22. a 23. rokem. 

```{r}
plot_kompetence_by(hlavni_data_long, "rozvijim", age, all_together = TRUE)
```

Při pohledu na jednotlivé kompetence vidíme, že žádné průměrné sebehodnocení rozvoje neroste.

```{r}
plot_kompetence_by(hlavni_data_long, "rozvijim", age)
plots$rozvijim_age_smooth <- plot_kompetence_by_smooth(hlavni_data_long, "rozvijim", age)
plots$rozvijim_age_smooth
```


## Skauting me rozviji

Tak a  do čtvrtice - celkový trend je klesající, podobně jako u "Rozvíjím se v tom". V jistém smyslu je asi žádoucí, aby zde byl klesající trend - s rostoucím věkem by skauting měl v rozvoji lidí asi hrát menší a menší roli. (a ač to je otravné, stále je možné, že to je kohortový efekt)

```{r}
plot_kompetence_by(hlavni_data_long, "skauting", age, all_together = TRUE)
```

U jednotlivých kompetencí se toho vlastně málo zajímavého děje - všechny mírně klesají, kromě pár, co zůstavají zhruba rovné: "2.B1 Svědomí", "2.B2 Slib, zákon", "4.C Členka týmu". Opět se to asi dá interpretovat optimisticky: roveři čím dál méně spoléhají na skauting ve všem kromě základních hodnot. Ale taky je možné, že to celé je jen tím, že starší lidé mají jinou míru/způsob sebereflexe. Jo a říkal jsem, že to může být kohortový efekt, kdy současný/nedávný skauting lépe rozvíjí mladé lidi než skauting před 10ti lety?

```{r}
plot_kompetence_by(hlavni_data_long, "skauting", age)
plots$skauting_age_smooth <- plot_kompetence_by_smooth(hlavni_data_long, "skauting", age)
plots$skauting_age_smooth 
```

# Rozdíly a nedostatky

Ještě se podíváme na rozdíly/kontrasty jednotlivých otázek.

```{r}
spocitej_data_rozdil <- function(hlavni_data_long, prvni, druhy, meritko_nazev) {
  typ_meritka <- meritka_kompetence[[meritko_nazev]]$type
  
  nazev_prvni <- rlang::as_name(enquo(prvni))
  nazev_druhy <- rlang::as_name(enquo(druhy))
  if(typ_meritka == "bool") {
    diff_fun <- function(x, y) {
      x & !y
    }
    popis <- paste0(nazev_prvni," ", popis_meritka(meritko_nazev), " zatímco ", nazev_druhy, " nikoliv")
  } else if(typ_meritka == "interval" || typ_meritka == "ordinal") {
    diff_fun <- `-`
    popis <- paste0(popis_meritka(meritko_nazev),": ",nazev_prvni," - ", nazev_druhy)
  }
  
  data_diff <- hlavni_data_long  %>%
      pivot_wider(id_cols = c("session", "kompetence","popis_pro_grafy", "age"), names_from = kategorie_kompetence, values_from = !!meritko_nazev) %>%
      mutate(rozdil = diff_fun({{prvni}},{{druhy}})) %>%
      filter(!is.na(rozdil))
  
  list(data = data_diff,
    popis = popis,
    meritko_nazev = meritko_nazev)
}

tabulka_rozdilu <- function(data_rozdil) {
  if(meritka_kompetence[[data_rozdil$meritko_nazev]]$type == "bool") {
    formatter = scales::percent
  } else {
    formatter = identity
  }
  nazev_prumer <- paste0(data_rozdil$popis, " (Průměr)")
  data_rozdil$data %>%
    group_by(popis_pro_grafy) %>%
    summarise(prumer = mean(rozdil)) %>%
    arrange(desc(prumer)) %>%
    mutate(!!nazev_prumer := formatter(prumer)) 
}



```

## Důležité vs. zvládám

```{r}
tabulka_dulezite_zvladam <- hlavni_data_long %>% spocitej_data_rozdil(dulezite, zvladam, "kompetence_pozitivni") %>% tabulka_rozdilu()
tabulka_dulezite_zvladam %>%
    select(-prumer)

```

```{r}

hlavni_data_long %>% spocitej_data_rozdil(dulezite, zvladam, "kompetence_odpoved") %>% tabulka_rozdilu() %>%
    select(-prumer)
```

```{r}
data_rozdil <- hlavni_data_long %>% 
  spocitej_data_rozdil(dulezite, zvladam, "kompetence_odpoved") %>% 
  get("data", .) %>%
  mutate(kategorie_kompetence = "rozdil dulezite-zvladam", kompetence_odpoved = rozdil)

data_rozdil %>%
  plot_kompetence_by("rozdil dulezite-zvladam", age, all_together = TRUE)

data_rozdil %>%
  plot_kompetence_by("rozdil dulezite-zvladam", age)
```



## Důležité vs. rozvíjím

Zajímavé je, že mezi top "nerozvíjené" patří aktivni obcan, tvořivost, které se zde posunuly dolů zatímco rodina k top nerozvíjeným nepatří, ale zde vede.

```{r}
tabulka_dulezite_rozvijim <- hlavni_data_long %>% spocitej_data_rozdil(dulezite, rozvijim, "kompetence_pozitivni") %>% tabulka_rozdilu()
tabulka_dulezite_rozvijim %>%
    select(-prumer)
```

```{r}
plot_tabulka_rozdil <- function(tabulka, indices = 5:1, text_y = 0.01) {
  tabulka[indices, ] %>% 
    mutate(kompetence = factor(kompetence, levels = kompetence)) %>% ggplot(aes(x = kompetence, y = prumer, label = scales::percent(prumer, accuracy = 1))) + geom_bar(stat = "identity") + coord_flip() + geom_text(y = text_y, size = 6, color = revize_cols("dark_blue")) + theme(axis.title = element_blank(), axis.ticks.x = element_blank(), axis.text.x =  element_blank())
}

plots$dulezite_rozvijim <- tabulka_dulezite_rozvijim %>% plot_tabulka_rozdil(indices = 7:1) + plot_annotation("Kontrast důležité x rozvíjím", subtitle = "Je to důležité, ale nerozvíjím se v tom")
plots$dulezite_rozvijim
```


Když zohledníme i velikost rozdílu, trochu se to přehází - hlavně vyplavou vztahy, svědomí a připraven na krize - opět něco, co se samo o sobě neobjevuje čast jako nerozvíjené.

```{r}
hlavni_data_long %>% spocitej_data_rozdil(dulezite, rozvijim, "kompetence_odpoved") %>% tabulka_rozdilu() %>%
    select(-prumer)
```


```{r}
data_rozdil <- hlavni_data_long %>% 
  spocitej_data_rozdil(dulezite, rozvijim, "kompetence_odpoved") %>% 
  get("data", .) %>%
  mutate(kategorie_kompetence = "rozdil dulezite-rozvijim", kompetence_odpoved = rozdil)

data_rozdil %>%
  plot_kompetence_by("rozdil dulezite-rozvijim", age, all_together = TRUE)

data_rozdil %>%
  plot_kompetence_by("rozdil dulezite-rozvijim", age)
```



## Důležité vs. skauting me rozviji

Tohle velmi blízce kopíruje obecně to, kde skauting lidi nerozvíjí, takže nepřínáší moc další informace.

```{r}
tabulka_dulezite_skauting <-  hlavni_data_long %>% spocitej_data_rozdil(dulezite, skauting, "kompetence_pozitivni") %>% tabulka_rozdilu()
tabulka_dulezite_skauting %>%
    select(-prumer)
```

```{r}
# tabulka_dulezite_skauting %>% plot_tabulka_rozdil(text_y = 0.03) + plot_annotation("Kontrast důležité x skauting", subtitle = "Je to důležité, ale skauting mě v tom nerozvíjí")
```


## Rozvijim se vs. skauting me rozviji

Opět poměrně kopíruje jen ty věci, kde mě skauting nerozvíjí...

```{r}
hlavni_data_long %>% spocitej_data_rozdil(rozvijim, skauting, "kompetence_pozitivni") %>% tabulka_rozdilu() %>%
    select(-prumer)

```

# Ještě projít

TODO: Dát kategorie kompetencí přes sebe?
Kompetence - nemají starší lidi širší škálu?


## Ulozit obrazky

```{r}
save_list_of_plots(plots,"shrnuti_kompetenci")
```


# Doplnky a kontroly

Nevymyká se nějaká kompetence svým rozložením odpovědí?
```{r}
histogram_kompetence <- function(data_long, kategorie) {
  sloupec_pro_popis <- paste0("duchovni_zivot.", kategorie)
  popisek <- popis_pro_plot(hlavni_data, !!sloupec_pro_popis)
  data_long %>% filter(kategorie_kompetence == kategorie, !is.na(kompetence_odpoved)) %>%
    ggplot(aes(kompetence_odpoved)) +
      geom_histogram(binwidth = 1) + facet_wrap(~kompetence) +
      ggtitle("Rozložení odpovědí dle kompetencí", subtitle = popisek) +
      vodorovne_popisky_x
}

histogram_kompetence(hlavni_data_long, "zvladam")
histogram_kompetence(hlavni_data_long, "dulezite")
histogram_kompetence(hlavni_data_long, "rozvijim")
histogram_kompetence(hlavni_data_long, "skauting")
```

# Jak se liší různá měřítka?

Korelace:

```{r}
hlavni_data_long %>% select(one_of(names(meritka_kompetence))) %>%
  as.matrix() %>% cor()
```

```{r save_plots}
save_list_of_plots(plots,"shrnuti_kompetenci")
```
