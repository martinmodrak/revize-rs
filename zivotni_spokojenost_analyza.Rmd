---
title: "Životní spokojenost a spokojenost v Junáku"
output:
  html_document:
    toc: yes
    number_sections: true
  word_document:
    toc: yes
    number_sections: true
    reference_docx: public_data/output_template.docx
date: '`r format(Sys.time(), "%d %B, %Y")`'

---

# Životní spokojenost roverů

```{r setup}
source(here::here("setup_dotaznik.R"), encoding = "UTF-8")
source(here::here("datasety_dotaznik.R"), encoding = "UTF-8")
knitr::opts_chunk$set(echo = FALSE, cache = TRUE)

pridej_pocty_mc <- function(cela_data) {
  cela_data %>%
    mutate(n_roli = cela_data %>% select(starts_with("role_skauting.")) %>% rowSums(),
           n_sluzba = cela_data %>% dplyr::select(starts_with("sluzba.")) %>% rowSums(),
           n_nastroje = cela_data %>% dplyr::select(starts_with("vychovne_nastroje.")) %>% rowSums(),
           n_s_cim_spokojen = cela_data %>% dplyr::select(starts_with("s_cim_spokojen.")) %>% rowSums(),
           n_s_cim_nespokojen = cela_data %>% dplyr::select(starts_with("s_cim_nespokojen.")) %>% rowSums())

}

lss_pro_kategorie <- function(var) {
  hlavni_data %>% 
    group_by(!!var) %>% 
    summarize(sd_lss = sd(lss, na.rm = T), n = sum(!is.na(lss)) ,n_NA = sum(is.na(lss)), lss = mean(lss, na.rm = T),
              spokojenost_clenstvim_v_rs = mean(as.numeric(spokojenost_clenstvim_v_rs), na.rm = T),
              spokojenost_s_fungovanim_v_junaku = mean(as.numeric(spokojenost_s_fungovanim_v_junaku), na.rm = T))
}


hlavni_data <- hlavni_data %>% pridej_pocty_mc() %>% 
  mutate(spokojenost_clenstvim_v_rs = as.numeric(spokojenost_clenstvim_v_rs),
         spokojenost_s_fungovanim_v_junaku = as.numeric(spokojenost_s_fungovanim_v_junaku))
```

## Shrnutí hlavních závěrů

Zásadní závěry z této části otázek podle nás jsou:
- roveři jsou obecně o něco spokojenější, než je průměrná populace, ale nijak to nesouvisí se spokojeností v Junáku
- spokojenost nezáleží na velikosti
- vyšší četnost akcí koreluje se spokojeností v Junáku
- není výrazný rozdíl s životní spokojeností dle demografických proměnných (pohlaví, kraj)
- u spokojeností s RS je na tom nejlépe Karlovarský kraj a nejhůře Moravskoslezský kraj, nicméně rozdíly nejsou velké. 
- vedouci roveru maji obecne o neco vyssi zivotni spokojenost i spokojenost s clenstvim v RS
- roveri, co zastavaji vice roli ve stredisku, byvaji obvykle spokojenejsi jak zivotne, tak s junakem
- cim vic maji roveri akci, tim jsou spokojenejsi
- zeny o neco vic vyuzivaji nastroje kmen, diar, kurzy, odborky
- muzi jsou o neco vic tahouni roveru, zeny zase oddilove radkyne

```{r spokojenost demografie}
lss_pro_kategorie(quo(sex))
t.test(lss~sex, hlavni_data %>% filter(sex != "jinak_neuvedeno"))
t.test(spokojenost_clenstvim_v_rs~sex, hlavni_data %>% filter(sex != "jinak_neuvedeno"))
effsize::cohen.d(spokojenost_clenstvim_v_rs~sex, hlavni_data %>% filter(sex != "jinak_neuvedeno") %>% mutate(sex = as.character(sex)))
effsize::cohen.d(spokojenost_s_fungovanim_v_junaku~sex, hlavni_data %>% filter(sex != "jinak_neuvedeno") %>% mutate(sex = as.character(sex)))
aov(lss~kraj,hlavni_data) %>% summary()

aov(spokojenost_clenstvim_v_rs~kraj,hlavni_data %>% filter(!kraj  %in% c("Karlovarský kraj","Nevím/Nejsem součástí žádného střediska"))) %>% summary()
aov(spokojenost_s_fungovanim_v_junaku~kraj,hlavni_data %>% filter(!kraj  %in% c("Karlovarský kraj","Nevím/Nejsem součástí žádného střediska"))) %>% summary()

hlavni_data %>% filter(kraj != "Nevím/Nejsem součástí žádného střediska") %>% group_by(kraj) %>% summarize(spokojenost_clenstvim_v_rs = mean(as.numeric(spokojenost_clenstvim_v_rs), na.rm=T)) %>% ggplot(aes(x = reorder(kraj, -spokojenost_clenstvim_v_rs), y = spokojenost_clenstvim_v_rs)) + geom_bar(stat = "identity") + xlab("Kraj") + ylab("spokojenost s členstvím v RS")

hlavni_data %>% filter(kraj != "Nevím/Nejsem součástí žádného střediska") %>% group_by(kraj) %>% summarize(spokojenost_s_fungovanim_v_junaku = mean(as.numeric(spokojenost_s_fungovanim_v_junaku), na.rm=T)) %>% ggplot(aes(x = kraj, y = spokojenost_s_fungovanim_v_junaku)) + geom_bar(stat = "identity")
x <- hlavni_data %>% filter(kraj %in% c("Karlovarský kraj", "Moravskoslezský kraj"))%>% mutate(kraj = forcats::fct_drop(kraj))
effsize::cohen.d(spokojenost_clenstvim_v_rs~kraj, x)


hlavni_data %>% filter(!is.na(spokojenost_clenstvim_v_rs)) %>% group_by(kraj,reg_c_strediska) %>% summarize(n = n()) %>% 
  filter(!is.na(reg_c_strediska)) %>% 
  group_by(kraj) %>% 
  summarize(n = n())
  
```
```{r zakladni lss analyzy}

cor.test(~let_v_junaku+lss,hlavni_data)
cor.test(~spokojenost_clenstvim_v_rs+lss,hlavni_data %>% mutate(spokojenost_clenstvim_v_rs = as.numeric(spokojenost_clenstvim_v_rs)))
cor.test(~spokojenost_clenstvim_v_rs+lss,hlavni_data %>% mutate(spokojenost_clenstvim_v_rs = as.numeric(spokojenost_s_fungovanim_v_junaku)))
cor.test(~spokojenost_s_fungovanim_v_junaku+lss,hlavni_data %>% mutate(spokojenost_s_fungovanim_v_junaku = as.numeric(spokojenost_s_fungovanim_v_junaku)))

hlavni_data %>% 
  group_by(pocet_clenu_spolecenstvi) %>% 
  summarize(lss = mean(lss, na.rm=T)) %>% 
  ggplot(aes(x=as.character(pocet_clenu_spolecenstvi),y=lss),cela_data) + geom_bar(stat = "identity")

hlavni_data %>% 
  mutate(frekvence_kratkych_akci = factor(frekvence_kratkych_akci, levels = c("nikdy","rocne","nekolik_rocne","mesicne","nekolik_mesicne","tydne","nekolik_tydne"))) %>% 
  group_by(frekvence_kratkych_akci) %>% 
  summarize(lss = mean(lss, na.rm=T)) %>% 
  ggplot(aes(x=frekvence_kratkych_akci,y=lss),cela_data) + geom_bar(stat = "identity")

hlavni_data %>% 
  mutate(frekvence_kratkych_akci = factor(frekvence_kratkych_akci, levels = c("nikdy","rocne","nekolik_rocne","mesicne","nekolik_mesicne","tydne","nekolik_tydne")),
         ) %>% 
  group_by(frekvence_kratkych_akci) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(as.numeric(spokojenost_clenstvim_v_rs), na.rm=T)) %>% 
  ggplot(aes(x=frekvence_kratkych_akci,y=spokojenost_clenstvim_v_rs),cela_data) + geom_bar(stat = "identity")

hlavni_data %>% 
  group_by(frekvence_vicedennich_akci) %>% 
  summarize(n = n())

hlavni_data %>% 
  group_by(frekvence_velkych_akci) %>% 
  summarize(n = n())


p1 <- hlavni_data %>% 
  mutate(frekvence_vicedennich_akci = factor(frekvence_vicedennich_akci, levels = c("nikdy","mene_nez_rocne","rocne","nekolik_rocne","mesicne","nekolik_mesicne"))) %>% 
  group_by(frekvence_vicedennich_akci) %>% 
  summarize(lss = mean(lss, na.rm=T)) %>% 
  ggplot(aes(x=frekvence_vicedennich_akci,y=lss),cela_data) + geom_bar(stat = "identity") 

p2 <- hlavni_data %>% 
  mutate(frekvence_vicedennich_akci = factor(frekvence_vicedennich_akci, levels = c("nikdy","rocne","nekolik_rocne","mesicne","nekolik_mesicne","tydne","nekolik_tydne"))) %>% 
  group_by(frekvence_vicedennich_akci) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(as.numeric(spokojenost_clenstvim_v_rs), na.rm=T)) %>% 
  ggplot(aes(x=frekvence_vicedennich_akci,y=spokojenost_clenstvim_v_rs),cela_data) + geom_bar(stat = "identity")
p1
p2

p1 <- hlavni_data %>% 
  mutate(frekvence_velkych_akci = factor(frekvence_velkych_akci, levels = c("nikdy","mene_nez_rocne","rocne","nekolik_rocne"))) %>% 
  group_by(frekvence_velkych_akci) %>% 
  summarize(lss = mean(lss, na.rm=T)) %>% 
  ggplot(aes(x=frekvence_velkych_akci,y=lss),cela_data) + geom_bar(stat = "identity") 

p2 <- hlavni_data %>% 
  mutate(frekvence_velkych_akci = factor(frekvence_velkych_akci, levels = c("nikdy","mene_nez_rocne","rocne","nekolik_rocne"))) %>% 
  group_by(frekvence_velkych_akci) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(as.numeric(spokojenost_clenstvim_v_rs), na.rm=T)) %>% 
  ggplot(aes(x=frekvence_velkych_akci,y=spokojenost_clenstvim_v_rs),cela_data) + geom_bar(stat = "identity")
p1/p2




lss_pro_kategorie(quo(kategorie_respondenta)) %>% ggplot(aes(x = as.character(kategorie_respondenta), y =lss)) + geom_bar(stat="identity") + xlab("kategorie respondenta") +   theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust = 0.5))

lss_pro_kategorie(quo(kategorie_respondenta)) %>% ggplot(aes(x = as.character(kategorie_respondenta), y =spokojenost_clenstvim_v_rs  )) + geom_bar(stat="identity") + xlab("kategorie respondenta") +   theme(aspect.ratio = 0.5)
  

lss_pro_kategorie(quo(role_skauting.vedouci_roveru)) %>% ggplot(aes(x = as.character(role_skauting.vedouci_roveru), y =lss)) + geom_bar(stat="identity") + xlab("role skauting") +   theme(aspect.ratio = 0.5)

lss_pro_kategorie(quo(role_skauting.vedouci_roveru)) %>% ggplot(aes(x = as.character(role_skauting.vedouci_roveru), y =spokojenost_clenstvim_v_rs)) + geom_bar(stat="identity") + xlab("role skauting") +   theme(aspect.ratio = 0.5)

effsize::cohen.d(as.numeric(lss)~as.character(role_skauting.vedouci_roveru), hlavni_data)
effsize::cohen.d(as.numeric(spokojenost_clenstvim_v_rs)~as.character(role_skauting.vedouci_roveru), hlavni_data)

lss_pro_kategorie(quo(zivotni_faze)) %>% 
  mutate(zivotni_faze = recode(as.character(zivotni_faze), `1`="Studuji",`2`="Pracuji",`3`="Studuji i pracuji",`4`="Nepracuji ani nestuduji")) %>% 
  ggplot(aes(x = as.character(zivotni_faze), y =spokojenost_clenstvim_v_rs  )) + geom_bar(stat="identity") + xlab("zivotni_faze") +   
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

lss_pro_kategorie(quo(zivotni_faze)) %>% 
  mutate(zivotni_faze = recode(as.character(zivotni_faze), `1`="Studuji",`2`="Pracuji",`3`="Studuji i pracuji",`4`="Nepracuji ani nestuduji")) %>% 
  ggplot(aes(x = as.character(zivotni_faze), y =lss  )) + geom_bar(stat="identity") + xlab("zivotni_faze")
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

lss_pro_kategorie(quo(kraj)) %>% 
  ggplot(aes(x = as.character(kraj), y =spokojenost_clenstvim_v_rs  )) + geom_bar(stat="identity") + xlab("zivotni_faze") +   
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

kraj_val <- lss_pro_kategorie(quo(kraj)) %>% 
  arrange(lss) %>% 
  mutate(kraj = haven::as_factor(kraj) %>% as.character()) %>% pull(kraj)

lss_pro_kategorie(quo(kraj)) %>% 
  arrange(lss) %>% 
  mutate(kraj = haven::as_factor(kraj) %>% as.character()) %>% 
  mutate(kraj = factor(kraj, levels = kraj_val)) %>% 
  ggplot(aes(x = kraj, y =lss  )) + geom_bar(stat="identity") + xlab("kraj")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

kraj_val <- lss_pro_kategorie(quo(kraj)) %>% 
  arrange(spokojenost_clenstvim_v_rs) %>% 
  mutate(kraj = haven::as_factor(kraj) %>% as.character()) %>% pull(kraj)

lss_pro_kategorie(quo(kraj)) %>% 
  arrange(spokojenost_clenstvim_v_rs) %>% 
  mutate(kraj = haven::as_factor(kraj) %>% as.character()) %>% 
  mutate(kraj = factor(kraj, levels = kraj_val)) %>% 
  ggplot(aes(x = kraj, y =spokojenost_clenstvim_v_rs  )) + geom_bar(stat="identity") + xlab("kraj")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

lss_pro_kategorie(quo(sex)) %>% 
  ggplot(aes(x = sex, y =spokojenost_clenstvim_v_rs  )) + geom_bar(stat="identity") + xlab("pohlavi")+theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
lss_pro_kategorie(quo(sex)) %>% 
  ggplot(aes(x = sex, y =lss  )) + geom_bar(stat="identity") + xlab("pohlavi")+theme(axis.text.x = element_text(angle = 45, hjust = 1))
    

lss_pro_kategorie(quo(sex))

```



```{r rozdelejless pro mc}


cela_data %>% select(starts_with("roleFA_"),lss) %>% cor(use = "complete.obs") %>% knitr::kable(digits = 2)

n_roli_tmp <- rowSums(cela_data %>% select(starts_with("role_skauting.")) %>% as.matrix())

cela_data <- cela_data %>% 
  mutate(n_roli = n_roli_tmp)
hlavni_data %>% 
  group_by(n_roli) %>% 
  summarize(lss = mean(lss, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_roli, y = lss, size = n)) + geom_point() + 
  stat_smooth()

hlavni_data %>% 
  group_by(n_roli) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_roli, y = spokojenost_clenstvim_v_rs, size = n)) + geom_point() + 
  stat_smooth()

hlavni_data %>% 
  mutate(vek_kateg =if_else(age <= 17, "mladsi", if_else(age >21, "starsi", NA_character_))) %>% 
  filter(!is.na(vek_kateg)) %>% 
  ggplot(aes(x=n_roli, y = as.numeric(lss), col = vek_kateg)) + 
  stat_smooth()

hlavni_data %>% 
  mutate(vek_kateg =if_else(age < 17, "mladsi", if_else(age >21, "starsi", NA_character_))) %>% 
  filter(!is.na(vek_kateg)) %>% 
  ggplot(aes(x=n_roli, y = as.numeric(lss), col = vek_kateg)) + 
  stat_smooth()


hlavni_data %>% 
  mutate(vek_kateg =if_else(age <= 17, "mladsi", if_else(age >21, "starsi", NA_character_))) %>% 
  filter(!is.na(vek_kateg)) %>% 
  ggplot(aes(x=n_roli, y = as.numeric(spokojenost_clenstvim_v_rs), col = vek_kateg)) + 
  stat_smooth()

hlavni_data %>% 
  mutate(vek_kateg =if_else(age < 17, "mladsi", if_else(age >21, "starsi", NA_character_))) %>% 
  filter(!is.na(vek_kateg)) %>% 
  ggplot(aes(x=n_roli, y = as.numeric(spokojenost_clenstvim_v_rs), col = vek_kateg)) + 
  stat_smooth()


hlavni_data %>% 
  ggplot(aes(x=n_roli, y = spokojenost_clenstvim_v_rs)) + 
  stat_smooth()

hlavni_data %>% 
  ggplot(aes(x=n_sluzba, y = spokojenost_clenstvim_v_rs)) + 
  stat_smooth(method = "lm")

hlavni_data %>% 
   group_by(n_sluzba) %>% 
   summarize(lss = mean(lss, na.rm = T), n =n()) %>% 
 ggplot(aes(x=n_sluzba, y = lss, size = n)) + geom_point()

hlavni_data %>% 
  group_by(n_sluzba) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_sluzba, y = spokojenost_clenstvim_v_rs, size = n)) + geom_point()

hlavni_data %>% 
  group_by(n_s_cim_spokojen) %>% 
  summarize(lss = mean(lss, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_s_cim_spokojen, y = lss, size = n)) + geom_point()

hlavni_data %>% 
  group_by(n_s_cim_spokojen) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_s_cim_spokojen, y = spokojenost_clenstvim_v_rs, size = n)) + geom_point()

hlavni_data %>% 
  group_by(n_s_cim_nespokojen) %>% 
  summarize(lss = mean(lss, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_s_cim_nespokojen, y = lss, size = n)) + geom_point()

hlavni_data %>% 
  group_by(n_s_cim_nespokojen) %>% 
  summarize(spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm = T), n =n()) %>% 
ggplot(aes(x=n_s_cim_nespokojen, y = spokojenost_clenstvim_v_rs, size = n)) + geom_point()



hlavni_data %>% 
  group_by(role_skauting.vedouci_roveru) %>% 
  summarize(lss = mean(lss, na.rm =T),
            spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm =T),
            n = n()) %>% 
  ggplot(aes(x=role_skauting.vedouci_roveru, y = spokojenost_clenstvim_v_rs, size = n)) + geom_bar(stat = "identity")

hlavni_data %>% 
  group_by(role_skauting.vedouci_roveru) %>% 
  summarize(lss = mean(lss, na.rm =T),
            spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm =T),
            n = n()) %>% 
  ggplot(aes(x=role_skauting.vedouci_roveru, y = lss, size = n)) + geom_bar(stat = "identity")



hlavni_data %>% 
  group_by(role_skauting.tahoun_roveru) %>% 
  summarize(m_spoko = mean(spokojenost_clenstvim_v_rs, na.rm =T),
            sd_spoko = sd(spokojenost_clenstvim_v_rs, na.rm =T),
            n = n())

cela_data %>% 
  group_by(role_skauting.tahoun_roveru) %>% 
  summarize(m_lss = mean(lss, na.rm =T),
            sd_lss = sd(lss, na.rm =T),
            n = n())


t.test(spokojenost_clenstvim_v_rs~role_skauting.vedouci_roveru,hlavni_data)
t.test(lss~role_skauting.vedouci_roveru,hlavni_data)


```

```{r rozdil kompetencni a lss}
expanded <- cela_data %>% expand_kompetence()

rozdil_dulezite_zvladam <- expanded %>% select(session, lss, kategorie_kompetence, kompetence_odpoved, kompetence) %>% filter(kategorie_kompetence %in% c("dulezite","zvladam")) %>%
  pivot_wider(id_cols = c("session", "kompetence", "lss"), names_from = kategorie_kompetence, values_from = kompetence_odpoved) %>%
  mutate(rozdil_dulezite_zvladam = dulezite - zvladam) %>%
  filter(!is.na(rozdil_dulezite_zvladam))

rozdil_dul_zvl_agg <- rozdil_dulezite_zvladam %>% 
  group_by(session) %>% 
  summarize(lss = mean(lss), rozdil_dulezite_zvladam = mean(rozdil_dulezite_zvladam)) 
rozdil_dul_zvl_agg %>% ggplot(aes(x = rozdil_dulezite_zvladam)) + geom_histogram()
rozdil_dul_zvl_agg %>% 
  cor.test(~lss+rozdil_dulezite_zvladam,.)
rozdil_dul_zvl_agg %>% 
  ggplot(aes(x=rozdil_dulezite_zvladam,y=lss)) + 
  geom_point() +
  stat_smooth()

lss_cor <- expanded %>% select(session, lss, spokojenost_clenstvim_v_rs,kategorie_kompetence, kompetence_odpoved, kompetence) %>% filter(kategorie_kompetence %in% c("dulezite","zvladam","rozvijim","skauting")) %>%
  pivot_wider(id_cols = c("session", "kompetence", "lss","spokojenost_clenstvim_v_rs"), names_from = kategorie_kompetence, values_from = kompetence_odpoved,values_fn = list(kompetence_odpoved = mean)) %>% 
  mutate(dulezite = unlist(dulezite))
  group_by(session) %>% 
  summarize(lss = mean(lss), 
            spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs), 
            dulezite = mean(dulezite),
            zvladam = mean(zvladam),
            rozvijim = mean(rozvijim),
            skauting = mean(skauting)
            )
m <- lss_cor %>% 
  select(lss, spokojenost_clenstvim_v_rs,dulezite, zvladam, rozvijim, skauting) %>% 
  as.matrix() %>% cor(use = "complete.obs") 
m %>% ggcorrplot::ggcorrplot(type = "lower", lab = T)
m <- m %>% 
  round(2) %>% 
  as.character()
m[upper.tri(m)] <- ""
  m %>% knitr::kable(digits = 2)

xxx <- cela_data %>% select(lss,ends_with("zvladam")) %>% as.matrix() %>% cor(use = "complete.obs") %>% round(2) %>% as_tibble(rownames = "var") %>% 
  select(var, lss) %>% filter(var!="lss") %>% arrange(lss) %>% mutate(var = str_remove(var, "_zvladam"))
lev <- xxx$var
xxx %>% mutate(zvladam = factor(var, levels = lev, ordered = T)) %>% 
  ggplot(aes(x = zvladam, y = lss)) + geom_bar(stat="identity") + xlab("Zvladam kompetence")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

xxx <- cela_data %>% select(lss,ends_with("rozvijim")) %>% as.matrix() %>% cor(use = "complete.obs") %>% round(2) %>% as_tibble(rownames = "var") %>% 
  select(var, lss) %>% filter(var!="lss") %>% arrange(lss) %>% mutate(var = str_remove(var, "_rozvijim"))
lev <- xxx$var
xxx %>% mutate(rozvijim = factor(var, levels = lev, ordered = T)) %>% 
  ggplot(aes(x = rozvijim, y = lss)) + geom_bar(stat="identity") + xlab("Rozvijim kompetence")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

xxx <- cela_data %>% select(lss,ends_with("dulezite")) %>% as.matrix() %>% cor(use = "complete.obs") %>% round(2) %>% as_tibble(rownames = "var") %>% 
  select(var, lss) %>% filter(var!="lss") %>% arrange(lss) %>% mutate(var = str_remove(var, "_dulezite"))
lev <- xxx$var
xxx %>% mutate(dulezite = factor(var, levels = lev, ordered = T)) %>% 
  ggplot(aes(x = dulezite, y = lss)) + geom_bar(stat="identity") + xlab("Dulezite kompetence")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

xxx <- cela_data %>% select(lss,ends_with("skauting"),-role_skauting) %>% as.matrix() %>% cor(use = "complete.obs") %>% round(2) %>% as_tibble(rownames = "var") %>% 
  select(var, lss) %>% filter(var!="lss") %>% arrange(lss) %>% mutate(var = str_remove(var, "_skauting"))
lev <- xxx$var
xxx %>% mutate(skauting = factor(var, levels = lev, ordered = T)) %>% 
  ggplot(aes(x = skauting, y = lss)) + geom_bar(stat="identity") + xlab("Skauting kompetence")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


### Roverske nastroje

```{r roverske nastroje faktorova analyza}
role_fa <- cela_data_role %>% select(starts_with("vychovne_nastroje."))
role_fa <- sapply(role_fa, as.character)
het.mat <- hetcor(role_fa)$cor
het.mat %>% knitr::kable(digits = 2)

psych::fa.parallel(het.mat, n.obs = nrow(role_fa))

nastroje_fa_res <- psych::fa(het.mat, n.obs = nrow(role_fa), nfactors = 3, rotate = "varimax")
nastroje_fa_res
```

```{r roverske nastroje a spokojenost}

cr <- hlavni_data %>% select(starts_with("vychovne_nastroje."),lss, spokojenost_clenstvim_v_rs) %>% as.matrix() %>% Hmisc::rcorr() 
cr$r %>%   knitr::kable(digits = 2)
ggcorrplot::ggcorrplot(cr$r,hc.order = T, type = "lower", lab =T)
```


### Co pomaha roveringu

```{r}
hlavni_data %>% select(starts_with("co_pomaha_")) %>% colnames()
xtabs(~co_pomaha_roveringu.financni_podpora+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.zpravodal+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.vyssi_mista+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.roversky_program+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.SI+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.akce_kratke+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.akce_dlouhe+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.neformalni_setkani+kategorie_respondenta,hlavni_data) %>% prop.table(margin = 2) %>% round(2)
xtabs(~co_pomaha_roveringu.socialni_site+kategorie_respondenta, hlavni_data) %>% prop.table(margin = 2) %>% round(2)

```

Obecne lidem, co maji zkusenost s roveringem prijde, ze pomahaji neformalni setkani oproti tem, co nikdy ve spolecentstvi nebyli (ti veri na program). Je to tedy dost o vztazizch a neformalnich setkavani



### Lidi, co jezdi na kurzy


```{r}
hlavni_data %>% 
  group_by(co_zazil.radcovsky_kurz) %>% 
  summarize(lss = mean(lss, na.rm = T),
            n_roli = mean(n_roli),
            n_sluzba = mean(n_sluzba),
            n_nastroje = mean(n_nastroje, na.rm = T),
            spokojenost_clenstvim_v_rs = mean(spokojenost_clenstvim_v_rs, na.rm = T),
            n_s_cim_spokojen = mean(n_s_cim_spokojen, na.rm = T),
            n_s_cim_nespokojen = mean(n_s_cim_nespokojen, na.rm = T)) 

hlavni_data %>% 
  group_by(co_zazil.cekatelky) %>% 
   summarize(lss = mean(lss, na.rm = T)/35,
            n_roli = mean(n_roli),
            n_sluzba = mean(n_sluzba),
            n_nastroje = mean(n_nastroje, na.rm = T),
            spokojenost_s_rp = mean(spokojenost_clenstvim_v_rs, na.rm = T),
            n_s_cim_spokojen = mean(n_s_cim_spokojen, na.rm = T),
            n_s_cim_nespokojen = mean(n_s_cim_nespokojen, na.rm = T)) %>% 
  pivot_longer(values_to = "hodnota",names_to = "promenna", cols = lss:n_s_cim_nespokojen) %>% 
  ggplot(aes(x=promenna,y=hodnota,fill=co_zazil.cekatelky)) + geom_bar(stat ="identity", position = "dodge") + 
  theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
t.test(spokojenost_clenstvim_v_rs ~ co_zazil.cekatelky, hlavni_data)
t.test(n_roli ~ co_zazil.cekatelky, hlavni_data)
effsize::cohen.d(n_roli ~ co_zazil.cekatelky, hlavni_data)
hlavni_data %>% 
  group_by(co_zazil.vudcovky) %>% 
   summarize(lss = mean(lss, na.rm = T)/35,
            n_roli = mean(n_roli),
            n_sluzba = mean(n_sluzba),
            n_nastroje = mean(n_nastroje, na.rm = T),
            spokojenost_s_rp = mean(spokojenost_clenstvim_v_rs, na.rm = T),
            n_s_cim_spokojen = mean(n_s_cim_spokojen, na.rm = T),
            n_s_cim_nespokojen = mean(n_s_cim_nespokojen, na.rm = T)) %>% 
  pivot_longer(values_to = "hodnota",names_to = "promenna", cols = lss:n_s_cim_nespokojen) %>% 
  ggplot(aes(x=promenna,y=hodnota,fill=co_zazil.vudcovky)) + geom_bar(stat ="identity", position = "dodge") + 
  theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
t.test(spokojenost_clenstvim_v_rs ~ co_zazil.vudcovky, hlavni_data)
effsize::cohen.d(spokojenost_clenstvim_v_rs ~ co_zazil.vudcovky, hlavni_data)

hlavni_data %>% 
  group_by(co_zazil.roversky_kurz) %>% 
  summarize(lss = mean(lss, na.rm = T)/35,
            n_roli = mean(n_roli),
            n_sluzba = mean(n_sluzba),
            n_nastroje = mean(n_nastroje, na.rm = T),
            spokojenost_s_rp = mean(spokojenost_clenstvim_v_rs, na.rm = T),
            n_s_cim_spokojen = mean(n_s_cim_spokojen, na.rm = T),
            n_s_cim_nespokojen = mean(n_s_cim_nespokojen, na.rm = T)) %>% 
  pivot_longer(values_to = "hodnota",names_to = "promenna", cols = lss:n_s_cim_nespokojen) %>% 
  ggplot(aes(x=promenna,y=hodnota,fill=co_zazil.roversky_kurz)) + geom_bar(stat ="identity", position = "dodge") + 
  theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
  
```

Obecně lidé, co byli na kurzech mají o něco větší spokojenost s roverským programem, ale hlavně zastávají více rolí. Není to překvapivé, neboť na kurzy typicky jezdí lidé, aby poté nějakou další roli mohli zastávat

## Vek a breaking points

```{r}
cela_data1 <- hlavni_data %>% filter(age >= 15 & age <=26)
p1 <-cela_data1 %>% ggplot(aes(x = age, y = lss)) + stat_smooth(method = "loess")
p2 <-cela_data1 %>% ggplot(aes(x = age, y = spokojenost_clenstvim_v_rs)) + stat_smooth(method = "loess")
p3 <-cela_data1 %>% ggplot(aes(x = age, y = n_roli)) + stat_smooth(method = "loess")
p4 <- cela_data1 %>% ggplot(aes(x = age, y = n_sluzba)) + stat_smooth(method = "loess")
cela_data1 %>% ggplot(aes(x = age, y = n_s_cim_spokojen)) + stat_smooth(method = "loess")
cela_data1 %>% ggplot(aes(x = age, y = n_s_cim_nespokojen)) + stat_smooth(method = "loess")

(p1|p2)/(p3|p4)

p1 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.financni_podpora))) + stat_smooth(method = "loess") + ggtitle("Financni podpora") +ylab("procenta")
p2 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.vyssi_mista))) + stat_smooth(method = "loess") + 
  ggtitle("Vyssi mista") +ylab("procenta")
p3 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.roversky_program))) + stat_smooth(method = "loess") +
  ggtitle("Roversky program") +ylab("procenta")
p4 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.akce_kratke))) + stat_smooth(method = "loess") +
  ggtitle("Kratke akce") +ylab("procenta")
p5 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.akce_dlouhe))) + stat_smooth(method = "loess") +
  ggtitle("Dlouhe akce") +ylab("procenta")
p6 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.neformalni_setkani))) + stat_smooth(method = "loess") +
  ggtitle("Neformalni setkani") +ylab("procenta")
p7 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.socialni_site))) + stat_smooth(method = "loess") +
  ggtitle("Socialni site") +ylab("procenta")
p8 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(co_pomaha_roveringu.jine))) + stat_smooth(method = "loess") +
  ggtitle("Jine") +ylab("procenta")

(p1|p2|p3|p4)/(p5|p6|p7|p8)


p1 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.pravidelne))) + stat_smooth(method = "loess") + ggtitle("Stredisko pravidelne") +ylab("procenta")
p2 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.je_spolecenstvi))) + stat_smooth(method = "loess") + 
  ggtitle("Je spolecenstvi") +ylab("procenta")
p3 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.vlastni_akce))) + stat_smooth(method = "loess") +
  ggtitle("Vlastni akce") +ylab("procenta")
p4 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.akce_pro_druhe))) + stat_smooth(method = "loess") +
  ggtitle("Akce pro druhe") +ylab("procenta")
p5 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.rozviji_se))) + stat_smooth(method = "loess") +
  ggtitle("Rozviji se") +ylab("procenta")
p6 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.roverske_heslo))) + stat_smooth(method = "loess") +
  ggtitle("Roverske heslo") +ylab("procenta")
p7 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.vedou))) + stat_smooth(method = "loess") +
  ggtitle("Stredisko vedou") +ylab("procenta")
p8 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_stredisko.bez_ulohy))) + stat_smooth(method = "loess") +
  ggtitle("Stredisko - bez ulohy") +ylab("procenta")

(p1|p2|p3|p4)/(p5|p6|p7|p8)

cela_data1 %>% group_by(age) %>% summarize(n =sum(!is.na(vyroky_o_roveringu_stredisko.bez_ulohy)),vyroky_o_roveringu_stredisko.bez_ulohy = mean(vyroky_o_roveringu_stredisko.bez_ulohy,na.rm=T)) %>% 
  ggplot(aes(x=age,y=vyroky_o_roveringu_stredisko.bez_ulohy, size = n)) + geom_point()


p1 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.pro_jednu_gen))) + stat_smooth(method = "loess") + ggtitle("Zazil pro jednu generaci") +ylab("procenta")
p2 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.podpora_strediska))) + stat_smooth(method = "loess") + 
  ggtitle("Podpora strediska") +ylab("procenta")
p3 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.rovering_na_SR))) + stat_smooth(method = "loess") +
  ggtitle("Rovering na SR") +ylab("procenta")
p4 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.vedeni_je_rovering))) + stat_smooth(method = "loess") +
  ggtitle("Vedeni je rovering") +ylab("procenta")
p5 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.koedukovany))) + stat_smooth(method = "loess") +
  ggtitle("Koedukovany") +ylab("procenta")
p6 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.spoluprace_mimo_stredisko))) + stat_smooth(method = "loess") +
  ggtitle("Spoluprace mimo stredisko") +ylab("procenta")
p7 <- cela_data1 %>% ggplot(aes(x = age, y = 100*as.numeric(vyroky_o_roveringu_zazil.kurzy_akce))) + stat_smooth(method = "loess") +
  ggtitle("Kurzy akce") +ylab("procenta")

(p1|p2|p3|p4)/(p5|p6|p7)
plot_vek_loess <- function(var,to_remove, group_var = NULL ) {
  
  if(is.null(group_var)) {
    cela_data1 %>% mutate(procenta = !!var) %>% 
      filter(sex != "jinak_neuvedeno") %>% 
    mutate(procenta = 100*as.numeric(procenta)) %>% 
    ggplot(aes(x = age, y = procenta)) + stat_smooth(method = "loess") + ggtitle(str_remove(as_label(quo(!!var)),to_remove))   
  } else {
    cela_data1 %>% 
      group_by(!!group_var) %>% 
      filter(sex != "jinak_neuvedeno") %>% 
      mutate(procenta = !!var) %>% 
    mutate(procenta = 100*as.numeric(procenta)) %>% 
    ggplot(aes(x = age, y = procenta, col = !!group_var)) + stat_smooth(method = "loess") + ggtitle(str_remove(as_label(quo(!!var)),to_remove))   
  }
  
}

plot_letvjunaku_loess <- function(var,to_remove ) {
  cela_data1 %>% mutate(procenta = !!var) %>% 
    mutate(procenta = 100*as.numeric(procenta)) %>% 
    ggplot(aes(x = let_v_junaku, y = procenta)) + stat_smooth(method = "loess") + ggtitle(str_remove(as_label(quo(!!var)),to_remove)) 
}

p1 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.rover_automaticky),"vyroky_o_roveringu.zazil_2")
p2 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.vstupni_ritual),"vyroky_o_roveringu.zazil_2")
p3 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.snadny_prechod),"vyroky_o_roveringu.zazil_2")
p4 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.pri_prechodu_schopny),"vyroky_o_roveringu.zazil_2")
p5 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.mladsi_starsi),"vyroky_o_roveringu.zazil_2")
p6 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.prechodovy_ritual),"vyroky_o_roveringu.zazil_2")
p7 <- plot_vek_loess(quo(vyroky_o_roveringu.zazil_2.roversky_slib),"vyroky_o_roveringu.zazil_2")

(p1|p2|p3|p4)/(p5|p6|p7)
plot_vek_loess(quo(role_skauting.druzinovy_radce),"role_skauting.druzinovy_radce", group_var = quo(sex))
p1 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_email),"komunikacni_kanaly_existujici_")
p2 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_instagram),"komunikacni_kanaly_existujici_")
p3 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_SI),"komunikacni_kanaly_existujici_")
p4 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_diar),"komunikacni_kanaly_existujici_")
p5 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_casopis_kmen),"komunikacni_kanaly_existujici_")
p6 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_facebook),"komunikacni_kanaly_existujici_")
p7 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_krizovatka),"komunikacni_kanaly_existujici_")
p8 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_vedouci),"komunikacni_kanaly_existujici_")
(p1|p2|p3|p4)/(p5|p6|p7|p8)

p1 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_knihy),"komunikacni_kanaly_existujici_")
p2 <- plot_vek_loess(quo(komunikacni_kanaly_existujici_rovernet),"komunikacni_kanaly_existujici_")
p3 <- plot_vek_loess(quo(komunikacni_kanaly_hypoteticke_roverska_aplikace),"komunikacni_kanaly_hypoteticke_")
p4 <- plot_vek_loess(quo(komunikacni_kanaly_hypoteticke_online_kalendar),"komunikacni_kanaly_hypoteticke_")
p5 <- plot_vek_loess(quo(komunikacni_kanaly_hypoteticke_web),"komunikacni_kanaly_hypoteticke_")
p6 <- plot_vek_loess(quo(komunikacni_kanaly_hypoteticke_e_knihy),"komunikacni_kanaly_hypoteticke_")
(p1/p2)
(p3|p4)/(p5|p6)
```

### Let v Junaku

```{r}
p1 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_email),"komunikacni_kanaly_existujici_")
p2 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_instagram),"komunikacni_kanaly_existujici_")
p3 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_SI),"komunikacni_kanaly_existujici_")
p4 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_diar),"komunikacni_kanaly_existujici_")
p5 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_casopis_kmen),"komunikacni_kanaly_existujici_")
p6 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_facebook),"komunikacni_kanaly_existujici_")
p7 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_krizovatka),"komunikacni_kanaly_existujici_")
p8 <- plot_letvjunaku_loess(quo(komunikacni_kanaly_existujici_vedouci),"komunikacni_kanaly_existujici_")
(p1|p2|p3|p4)/(p5|p6|p7|p8)

p1 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_rover_automaticky),"vyroky_o_roveringu.zazil_2_")
p2 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_vstupni_ritual),"vyroky_o_roveringu.zazil_2_")
p3 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_snadny_prechod),"vyroky_o_roveringu.zazil_2_")
p4 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_pri_prechodu_schopny),"vyroky_o_roveringu.zazil_2_")
p5 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_mladsi_starsi),"vyroky_o_roveringu.zazil_2_")
p6 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_prechodovy_ritual),"vyroky_o_roveringu.zazil_2_")
p7 <- plot_letvjunaku_loess(quo(vyroky_o_roveringu.zazil_2_roversky_slib),"vyroky_o_roveringu.zazil_2_")

(p1|p2|p3|p4)/(p5|p6|p7)

p1 <- plot_letvjunaku_loess(quo(vychovne_nastroje_jine),"vychovne_nastroje_")
p2 <- plot_letvjunaku_loess(quo(vychovne_nastroje_vyzvy),"vychovne_nastroje_")
p3 <- plot_letvjunaku_loess(quo(vychovne_nastroje_projekty),"vychovne_nastroje_")
p4 <- plot_letvjunaku_loess(quo(vychovne_nastroje_diar),"vychovne_nastroje_")
p5 <- plot_letvjunaku_loess(quo(vychovne_nastroje_zacatek),"vychovne_nastroje_")
p6 <- plot_letvjunaku_loess(quo(vychovne_nastroje_casopis_kmen),"vychovne_nastroje_")
p7 <- plot_letvjunaku_loess(quo(vychovne_nastroje_vlastni_stezky),"vychovne_nastroje_")
p8 <- plot_letvjunaku_loess(quo(vychovne_nastroje_odborky),"vychovne_nastroje_")

(p1|p2|p3|p4)/(p5|p6|p7|p8)

p1 <- plot_letvjunaku_loess(quo(vychovne_nastroje_zahranici),"vychovne_nastroje_")
p2 <- plot_letvjunaku_loess(quo(vychovne_nastroje_velke_akce),"vychovne_nastroje_")
p3 <- plot_letvjunaku_loess(quo(vychovne_nastroje_kurzy),"vychovne_nastroje_")
p4 <- plot_letvjunaku_loess(quo(vychovne_nastroje_putovani),"vychovne_nastroje_")
p5 <- plot_letvjunaku_loess(quo(vychovne_nastroje_rovernet),"vychovne_nastroje_")
p6 <- plot_letvjunaku_loess(quo(vychovne_nastroje_wiki),"vychovne_nastroje_")
p7 <- plot_letvjunaku_loess(quo(vychovne_nastroje_nic),"vychovne_nastroje_")

(p1|p2|p3|p4)/(p5|p6|p7)
```

### Roveri v kmeni vs roveri bez kmene

```{r}
typ_respondednta_plot <- function(var) {
  
  cela_data1 %>% mutate(kategorie_respondenta_full = as.character(kategorie_respondenta_full)) %>% 
    ggplot(aes(x=kategorie_respondenta_full, y=!!var)) + stat_summary(fun.data = "mean_cl_boot") +theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
}
typ_respondednta_plot(quo(lss))
typ_respondednta_plot(quo(spokojenost_clenstvim_v_rs))
typ_respondednta_plot(quo(n_roli))
typ_respondednta_plot(quo(n_sluzba))
typ_respondednta_plot(quo(n_nastroje))
typ_respondednta_plot(quo(n_s_cim_spokojen))
typ_respondednta_plot(quo(n_s_cim_nespokojen))

```

### Muzi vs zeny

```{r}
hlavni_data %>% 
  mutate(sex = haven::as_factor(sex)) %>% 
  group_by(sex) %>% 
   summarize(lss = mean(lss, na.rm = T)/35,
            n_roli = mean(n_roli, na.rm = T),
            n_sluzba = mean(n_sluzba, na.rm = T),
            n_nastroje = mean(n_nastroje, na.rm = T),
            spokojenost_s_rp = mean(spokojenost_clenstvim_v_rs, na.rm = T),
            n_s_cim_spokojen = mean(n_s_cim_spokojen, na.rm = T),
            n_s_cim_nespokojen = mean(n_s_cim_nespokojen, na.rm = T)) %>% 
  pivot_longer(values_to = "hodnota",names_to = "promenna", cols = lss:n_s_cim_nespokojen) %>% 
  ggplot(aes(x=promenna,y=hodnota,fill=sex)) + geom_bar(stat ="identity", position = "dodge") + 
  theme(aspect.ratio = 0.5) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

hlavni_data %>% 
  filter(sex!="jinak_neuvedeno") %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("vychovne_nastroje.")) %>% 
  pivot_longer(cols = starts_with("vychovne_nastroje."), values_to = "procenta", names_to = "nastroj") %>% 
  mutate(nastroj = str_remove(nastroj,"vychovne_nastroje."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=nastroj,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

hlavni_data %>% 
  filter(sex!="jinak_neuvedeno") %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("role_skauting.")) %>% 
  pivot_longer(cols = starts_with("role_skauting."), values_to = "procenta", names_to = "role") %>% 
  mutate(role = str_remove(role,"role_skauting."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=role,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

hlavni_data %>% 
  filter(sex!="jinak_neuvedeno") %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("s_cim_spokojen.")) %>% 
  pivot_longer(cols = starts_with("s_cim_spokojen."), values_to = "procenta", names_to = "s_cim_spokojen") %>% 
  mutate(s_cim_spokojen = str_remove(s_cim_spokojen,"s_cim_spokojen."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=s_cim_spokojen,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  filter(sex!=3) %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("s_cim_nespokojen_")) %>% 
  pivot_longer(cols = starts_with("s_cim_nespokojen_"), values_to = "procenta", names_to = "s_cim_nespokojen") %>% 
  mutate(s_cim_nespokojen = str_remove(s_cim_nespokojen,"s_cim_nespokojen_"),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=s_cim_nespokojen,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

xtabs(~kategorie_respondenta_full+sex, cela_data)

cela_data %>% 
  filter(sex!=3) %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("sluzba_")) %>% 
  pivot_longer(cols = starts_with("sluzba_"), values_to = "procenta", names_to = "sluzba") %>% 
  mutate(sluzba = str_remove(sluzba,"sluzba_"),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=sluzba,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  filter(sex!=3) %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("sluzba_")) %>% 
  pivot_longer(cols = starts_with("sluzba_"), values_to = "procenta", names_to = "sluzba") %>% 
  mutate(sluzba = str_remove(sluzba,"sluzba_"),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=sluzba,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  filter(sex!=3) %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("vyroky_o_roveringu."),-starts_with("vyroky_o_roveringu.stredisko"),-vyroky_o_roveringu.zazil,-vyroky_o_roveringu.zazil_2) %>% 
  pivot_longer(cols = starts_with("vyroky_o_roveringu."), values_to = "procenta", names_to = "vyroky_o_roveringu") %>% 
  mutate(vyroky_o_roveringu = str_remove(vyroky_o_roveringu,"vyroky_o_roveringu.zazil_") %>% str_remove("2_"),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=vyroky_o_roveringu,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  filter(sex!=3) %>% 
  mutate(sex = haven::as_factor(sex)) %>%
  select(sex,starts_with("problemy_roveringu."),-starts_with("problemy_roveringu.stredisko")) %>% 
  pivot_longer(cols = starts_with("problemy_roveringu."), values_to = "procenta", names_to = "problemy_roveringu") %>% 
  mutate(problemy_roveringu = str_remove(problemy_roveringu,"problemy_roveringu."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=problemy_roveringu,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  select(sex,starts_with("fungovani_skautskeho_oddilu.")) %>% 
  pivot_longer(cols = starts_with("fungovani_skautskeho_oddilu."), values_to = "procenta", names_to = "fungovani_skautskeho_oddilu") %>% 
  mutate(fungovani_skautskeho_oddilu = str_remove(fungovani_skautskeho_oddilu,"fungovani_skautskeho_oddilu."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=fungovani_skautskeho_oddilu,y=procenta,col = sex,group = sex)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```


```{r}
cela_data %>%
  select(pocet_clenu_spolecenstvi,starts_with("fungovani_skautskeho_oddilu.")) %>% 
  pivot_longer(cols = starts_with("fungovani_skautskeho_oddilu."), values_to = "procenta", names_to = "fungovani_skautskeho_oddilu") %>% 
  mutate(fungovani_skautskeho_oddilu = str_remove(fungovani_skautskeho_oddilu,"fungovani_skautskeho_oddilu."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=fungovani_skautskeho_oddilu,y=procenta,col = pocet_clenu_spolecenstvi,group = pocet_clenu_spolecenstvi)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 

cela_data %>% 
  group_by(pocet_clenu_spolecenstvi) %>% 
  summarize(lss = mean(lss, na.rm = T),
            spoko_rp = mean(spokojenost_clenstvim_v_rs),
            n=n())


cela_data %>%
  
    select(pocet_clenu_spolecenstvi,starts_with("vyroky_o_roveringu."),-starts_with("vyroky_o_roveringu.stredisko"),-vyroky_o_roveringu.zazil,-vyroky_o_roveringu.zazil_2) %>% 
  pivot_longer(cols = starts_with("vyroky_o_roveringu."), values_to = "procenta", names_to = "vyroky_o_roveringu") %>% 
  mutate(vyroky_o_roveringu = str_remove(vyroky_o_roveringu,"vyroky_o_roveringu."),
         procenta = as.numeric(procenta)) %>% 
  
  ggplot(aes(x=vyroky_o_roveringu,y=procenta,col = pocet_clenu_spolecenstvi,group = pocet_clenu_spolecenstvi)) +
  stat_summary(fun.data = "mean_cl_boot") + 
  stat_summary(fun.y = "mean",geom = "line")+
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) 
```
