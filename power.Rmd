---
title: "Power analysis pro hlavní část"
output: html_notebook
---

```{r setup}
library(pwr)
library(here)
library(brms)
library(tidyverse)
```

A quick frequentist estimate

```{r}
power = 0.8
alpha = 0.05
power_vals <- tibble(n_predictors = c(10, 20, 30, 40)) %>%
  #crossing(tibble(f2 = c(0.02, 0.15, 0.35))) %>%
  crossing(tibble(sample_size = seq(from = 100, to = 1500, length.out = 100) %>% round())) %>%
  rowwise() %>%
  mutate(f2 = pwr.f2.test(u = n_predictors, v = sample_size - n_predictors - 1, sig.level = alpha, power = power)$f2) %>%
  ungroup()


power_vals %>%
  mutate(n_predictors = as.factor(n_predictors)) %>%
  ggplot(aes(x = sample_size, y = f2, color = n_predictors, group = n_predictors )) +
  geom_line() +
  geom_hline(yintercept = 0.02) +
  geom_hline(yintercept = 0.15) +
  geom_hline(yintercept = 0.35) +
  scale_y_log10()
  
```

Using the SBC code and full simulations:

```{r}
settings <- tibble(N = c(250, 500, 750, 1000)) %>% crossing(  

sbc_results <- sbc(model, function() { simulate_data(N = 100, N_questions = 2, N_fixed = 2, ncat = 4, N_random_groups = numeric(0),  N_monotonic = 0, questions_correlation = TRUE)}, N_steps = sbc_steps, control = list(adapt_delta = 0.99))
```


