---
title: "Stav roveringu"
output: 
  html_document:
    code_folding: hide
    toc: true
---

```{r setup}
source(here::here("R","setup_dotaznik.R"), encoding = "UTF-8")
source(here::here("R","datasety_dotaznik.R"), encoding = "UTF-8")

```


```{r}
plots <- list() 
```

# Životní cyklus rovera


```{r}
plots$roky_ve_spolecenstvi <- hlavni_data %>% filter(!is.na(let_v_kmeni)) %>% ggplot(aes( x = let_v_kmeni)) + geom_histogram(binwidth = 1) + ggtitle("Počet let ve společenství") + scale_x_continuous("Let ve společenství") + scale_y_continuous("Počet") + vodorovne_popisky_x 
plots$roky_ve_spolecenstvi
```

Obrázek výše obsahuje ukončená i neukončená členství - je to tedy spíše dolní odhad (lidé, kteří neukončili tak ještě budou pokračovat a zvednou to)


TODO censored model pro dobu ve společenství.

```{r}
kolik_roveru_dele_nez_tri_roky <- mean(hlavni_data$let_v_kmeni > 3, na.rm = TRUE)
```

Cca `r scales::percent(kolik_roveru_dele_nez_tri_roky)` roverů vydrželo v kmeni více jak 3 roky.

```{r}
if(sum(hlavni_data$frekvence_kratkych_akci < "mesicne", na.rm = TRUE) !=
   sum(hlavni_data$frekvence_kratkych_akci %in% c("nevyplneno", "nikdy","rocne","nekolik_rocne"), na.rm = TRUE)) {
  stop("Neplatny ordering")
}

```


Celkem nepřekvapivě klesá aktivita kmenů s věkem jejich členů:

```{r}
plots$aktivita_vek <- hlavni_data %>% 
  filter(kategorie_respondenta_full == "nyni_spolecenstvi") %>%
  plot_binarni_s_nejistotou(c("kmen_aktivni_zaklad","kmen_aktivni_velmi"), age, names_prefix = "kmen_") +
  plot_annotation("Aktivita (frekvence akcí) - věk\nJen současní členové") + scale_x_continuous("Věk")
           
plots$aktivita_vek

```

Otázkou je, jestli je to spíše věkem členů nebo délkou trvání kmene. Délku existence kmene nemáme, ale můžeme se podívat na počet let v kmeni

```{r}
plots$aktivita_let_v_kmeni <- hlavni_data %>% 
  filter(kategorie_respondenta_full == "nyni_spolecenstvi", let_v_kmeni < 8) %>%
  plot_binarni_s_nejistotou(c("kmen_aktivni_zaklad","kmen_aktivni_velmi"), let_v_kmeni, names_prefix = "kmen_") +
  plot_annotation("Aktivita (frekvence akcí) - let v kmeni\nJen současní členové")
           
plots$aktivita_let_v_kmeni
```

Trend je výraznější u věku, takže bych spíš vsadil na věk. Nedá se to ale dobře rozlišit, protože to spolu hodně koreluje.



```{r}
if(any(hlavni_data$let_v_junaku < hlavni_data$let_v_kmeni, na.rm = TRUE)) {
  stop("Nekdo byl dele v Junaku nez v kmeni")
}

data_vstupy <- hlavni_data %>% mutate(
  vek_vstupu_do_kmene = if_else(kategorie_respondenta_full == "nyni_spolecenstvi", age - let_v_kmeni, NA_real_),
  vek_vstupu_do_junaka = age - let_v_junaku)

plots$vek_vstupu_do_kmene <- data_vstupy %>% filter(!is.na(vek_vstupu_do_kmene)) %>%
  ggplot(aes(x = vek_vstupu_do_kmene)) + geom_histogram(binwidth = 1) + vodorovne_popisky_x + 
  scale_x_continuous(breaks = c(13, 15, 18, 21, 24)) +
  ggtitle("Věk vstupu do kmene\nJen členi společenství")

plots$vek_vstupu_do_kmene
```

Věk vstupu určen z otázek "Jak dlouho jsi ve společenství" a "Věk", proto lze určit jen u těch, kdo nyní jsou ve společenství. Každopádně málokdo vstupuje do kmene později než těsně po skautském věku.


```{r}
hlavni_data %>% filter(kategorie_respondenta_full == "nyni_spolecenstvi") %>%
  mutate(spise_spokojen = spokojenost_clenstvim_v_rs > 4, naprosto_spokojen = spokojenost_clenstvim_v_rs > 6) %>%
  plot_binarni_s_nejistotou(c("spise_spokojen","naprosto_spokojen"), age) + scale_x_continuous("Věk") + plot_annotation("Spokojen s členstvím v RS - Věk\nJen současní členové")
  
```

# Aktivita kmenů

Na frekvenci akcí jsme se ptali jen současných členů (nevěřili jsme, že bývalí si to budou dobře pamatovat).

```{r}
plots$frekvence_kratkych_akci <- plot_summary_mc(hlavni_data, frekvence_kratkych_akci, "Frekvence kratších akcí", order_by_podil = FALSE, invert_color_threshold = 0.03)
plots$frekvence_kratkych_akci

```

```{r}
plots$frekvence_vicedennich_akci <- plot_summary_mc(hlavni_data, frekvence_vicedennich_akci, "Frekvence vícedenních akcí", order_by_podil = FALSE, invert_color_threshold = 0.03)
plots$frekvence_vicedennich_akci

```
```{r}
plots$frekvence_velkych_akci <- plot_summary_mc(hlavni_data, frekvence_velkych_akci, "Frekvence velkých akcí", order_by_podil = FALSE)
plots$frekvence_velkych_akci

```

```{r}
plots$spokojenost_frekvence_akci_vek <- hlavni_data %>% 
  filter(kategorie_respondenta == "nyni_spolecenstvi") %>%
  plot_binarni_s_nejistotou(c("s_cim_spokojen.cetnost_akci"), age, na.rm = TRUE) + plot_annotation("Spokojen s frekvencí akcí dle věku", "Jen současní členové")

plots$spokojenost_frekvence_akci_vek
```

Mohli bychom ukázat i s čím jsou nespokojeni, ale křivka je pak vlastně jen inverzní. To samé u dalších obrázků.

Obecně čím více akcí, tím spokojenější s frekvencí akcí. Nicméně zhruba čtvrtina současných roverů je spokojená s četností "nikdy"

```{r}
plots$spokojenost_frekvence_akci_kratke_akce <- hlavni_data %>%
  filter(kategorie_respondenta == "nyni_spolecenstvi") %>%
  plot_binarni_s_nejistotou("s_cim_spokojen.cetnost_akci", frekvence_kratkych_akci, na.rm = TRUE) + plot_annotation("Spokojen s frekvencí akcí dle frekvence", "Krátké akce")
plots$spokojenost_frekvence_akci_kratke_akce  
```

```{r}
plots$spokojenost_frekvence_akci_vicedenni_akce <- hlavni_data %>%
  filter(kategorie_respondenta == "nyni_spolecenstvi") %>%
  plot_binarni_s_nejistotou("s_cim_spokojen.cetnost_akci", frekvence_vicedennich_akci, na.rm = TRUE) + plot_annotation("Spokojen s frekvencí akcí dle frekvence", "Vícedenní akce")
plots$spokojenost_frekvence_akci_vicedenni_akce  
```

```{r}
plots$spokojenost_frekvence_akci_velke_akce <- hlavni_data %>%
  filter(kategorie_respondenta == "nyni_spolecenstvi") %>%
  plot_binarni_s_nejistotou("s_cim_spokojen.cetnost_akci", frekvence_velkych_akci, na.rm = TRUE) + plot_annotation("Spokojen s frekvencí akcí dle frekvence", "Velké akce")
plots$spokojenost_frekvence_akci_velke_akce  
```

Frekvence akcí spolu jakž takž korelují

```{r}
hlavni_data %>% 
  filter(frekvence_kratkych_akci != explicit_na_level) %>%
  group_by(frekvence_kratkych_akci, frekvence_vicedennich_akci) %>%
  summarise(pocet = n()) %>%
  group_by(frekvence_kratkych_akci) %>%
  mutate(podil_vicedennich = pocet / sum(pocet)) %>%
  ggplot(aes(x = frekvence_kratkych_akci, y = frekvence_vicedennich_akci, fill = podil_vicedennich)) + 
  geom_raster() + scale_x_discrete() + scale_y_discrete() + scale_fill_revize(discrete = FALSE)

hlavni_data %>%
  filter(frekvence_kratkych_akci != explicit_na_level) %>%
  group_by(frekvence_velkych_akci, frekvence_vicedennich_akci) %>%
  summarise(pocet = n()) %>%
  group_by(frekvence_vicedennich_akci) %>%
  mutate(podil_velkych = pocet / sum(pocet)) %>%
  ggplot(aes(x = frekvence_vicedennich_akci, y = frekvence_velkych_akci, fill = podil_velkych)) +
  geom_raster() + scale_x_discrete() + scale_y_discrete() + scale_fill_revize(discrete = FALSE)

```


# Využívání nástrojů


Při interpretaci výsledků níže brát v potaz, že "Velké roverské akce" si nemuseli všichni vyložit jako "Obrok a spol." a mohli do toho třeba zahrnout expedice apod.

```{r}
plots$vychovne_nastroje <- plot_summary_mc(hlavni_data, vychovne_nastroje, "Používáme tyto výchovné nástroje")
plots$vychovne_nastroje
```

Moc se to nezmění, když se podíváme jen na současné.


```{r}
plots$vychovne_nastroje_jen_soucasni <- hlavni_data %>%
  filter(kategorie_respondenta_full == "nyni_spolecenstvi") %>% 
  plot_summary_mc(vychovne_nastroje, "Používáme tyto výchovné nástroje", subtitle = "Jen vedoucí kmenu")
plots$vychovne_nastroje_jen_soucasni
```

Taky žádná velká změna, když se podíváme jen na lidi, co jsou ve vedení společenství (označili jako svou roli "Vedoucí roverského společenství", "Člen rady roverského kmene" nebo "(Neformální) tahoun roverského společenství".

```{r}
plots$vychovne_nastroje_jen_vedeni <- hlavni_data %>%
  filter(role_skauting.tahoun_roveru | role_skauting.vedouci_roveru | role_skauting.clen_rady_roveru) %>% 
  plot_summary_mc(vychovne_nastroje, "Používáme tyto výchovné nástroje", subtitle = "Jen lidé ve vedení společenství")
plots$vychovne_nastroje_jen_vedeni
```




```{r}
plots$vychovne_nastroje_top <- plot_summary_mc(hlavni_data, vychovne_nastroje, "Nejpoužívanější výchovné nástroje", min_podil =  0.25)
plots$vychovne_nastroje_top
```

```{r}
plots$vychovne_nastroje_bottom <- plot_summary_mc(hlavni_data, vychovne_nastroje, "Nejméně používané výchovné nástroje", max_podil =  0.15, invert_color_threshold = 0.01)
plots$vychovne_nastroje_bottom
```


TODO: Porovnat s průzkumem na Obroku!


### Otázka RO:Je RSP vůbec zavedený?

```{r}
podil_nepouziva_nic <- mean(hlavni_data$vychovne_nastroje.nic, na.rm = TRUE)
podil_pouziva_projekty_vyzvy <- hlavni_data %>% 
  summarise(podil = mean(vychovne_nastroje.vyzvy & vychovne_nastroje.projekty, na.rm = TRUE)) %>% pull(podil)
  
```

Hodně roverů (`r scales::percent(podil_nepouziva_nic)`) nepoužívá žádné výchovné nástroje. Přestože kolem 40% roverů používá výzvy nebo projekty, jen `r scales::percent(podil_pouziva_projekty_vyzvy)` jich používá obojí. Roverský začátek jako jeden z mála zcela konkrétních výstupů používá jen hodně málo roverů.

Celkově bych spíše řekl, že roverský program není zavedený.


### Muži a ženy 

Korelace rozdílů v mužsko-ženských použití nástrojů a spokojenosti ve společenství, tj. Je něco co “cpeme holkám”?

```{r}
plots$nastroje_rozdil_pohlavi <- hlavni_data %>%
  filter(!is.na(vychovne_nastroje)) %>%
  pivot_longer(starts_with("vychovne_nastroje."), names_prefix = "vychovne_nastroje.", names_to = "nastroj",
                values_to = "pouziva") %>%
  group_by(nastroj) %>%
  summarise(vice_u_muzu = mean(pouziva[sex == "muz"]) - mean(pouziva[sex == "zena"])) %>%
  ungroup() %>%
  mutate(nastroj = fct_reorder(nastroj, vice_u_muzu)) %>%
  ggplot(aes(x = nastroj, y = vice_u_muzu)) + geom_bar(stat = "identity") + scale_y_continuous("Muži - ženy", labels = scales::percent) + plot_annotation("Využívání nastrojů rovery a rangers")

plots$nastroje_rozdil_pohlavi
```


TODO: rozdíly v pohlaví A ve spokojenosti - trošku komplikované, zatím odkládám.

### Organizace společenství

Dotaz RO: Čekali bychom, že velké akce jsou důležité pro společenství, co není moc organizované, ale data to možná nepotvrzují.

Skutečně se to moc nezdá, kmeny s organizací (tahoun, rada, vudce) jsou na tom skoro stejně jako kmeny bez tohoto.

```{r}
hlavni_data %>% plot_binarni_s_nejistotou("vychovne_nastroje.velke_akce", je_organizovan, na.rm = TRUE)
hlavni_data %>% plot_binarni_s_nejistotou("vychovne_nastroje.velke_akce", organizace_spolecenstvi.formalni_vudce_zhury, na.rm = TRUE)
```



TODO: Přispívá RSP k nějakým problémům roveringu?
TODO: Může RSP v principu fungovat navzdory problémům roveringu?

# Roveři ve vedení oddílu

```{r}
if(any(!is.na(hlavni_data$vyroky_o_roveringu_stredisko) & !is.na(hlavni_data$vyroky_o_roveringu_zazil))) {
  stop("Neoddělené výroky")
}
podil_vedeni_rovering <- mean(hlavni_data$vyroky_o_roveringu_zazil.vedeni_je_rovering, na.rm = TRUE)
labels_vyroky_o_roveringu_zazil <- popisky_voleb(hlavni_data, vyroky_o_roveringu_zazil)
popis_vedeni_je_rovering <- names(labels_vyroky_o_roveringu_zazil)[labels_vyroky_o_roveringu_zazil == "vedeni_je_rovering"]
```

Překvapení: `r scales::percent(podil_vedeni_rovering)` označilo, že "`r popis_vedeni_je_rovering`".

```{r}
plots$dalsi_role_roveru <- hlavni_data %>%
  filter(je_rover) %>%
  plot_summary_mc(role_skauting, "Další role roverů", subtitle = "Rover = vybral roverskou roli", exclude_values = c("clen_roveru", "tahoun_roveru", "rover_sam", "vedouci_roveru","clen_rady_roveru", "tym_akce_mimo", "__nic", "tym_akce_stredisko"))
plots$dalsi_role_roveru  

podil_aspon_nejak_funkce <- hlavni_data %>%
  filter(je_rover) %>% 
  summarise(podil = mean(role_skauting.vedouci_zastupce_oddilu | 
                           role_skauting.clen_vedeni_oddilu |
                           role_skauting.oddilovy_radce)) %>% pull(podil)
podil_aspon_nejak_funkce
```


Velká část roverů (`r scales::percent(podil_aspon_nejak_funkce)`) zastává aspoň jednu funkci v oddíle mladších členů (vedoucí, zástupce, člen vedení, oddílový rádce).

Role "družinový rádce" mi přijde podezřelá - skutečně je tolik starší družinových rádců?

```{r}
hlavni_data %>% plot_binarni_s_nejistotou("role_skauting.druzinovy_radce", age, na.rm = TRUE) + plot_annotation("Podíl družinových rádců dle věku")
```

Vzhledem k tomu, že asi 15% 21 letých a starších stále označilo "družinový rádce" je možné, že nemalá část lidí rozuměla otázce ve smyslu "byli jste někdy XX". Musíme tedy role brát s opatrností.

```{r}
hlavni_data %>% plot_binarni_s_nejistotou("role_skauting.vedouci_zastupce_oddilu", age, na.rm = TRUE) + plot_annotation("Podíl vedoucích/zástupců oddílu dle věku")
hlavni_data %>% plot_binarni_s_nejistotou("role_skauting.clen_vedeni_oddilu", age, na.rm = TRUE) + plot_annotation("Podíl členů vedení dle věku")
```



```{r}
hlavni_data %>% plot_binarni_s_nejistotou("ma_vudcovskou_roli", frekvence_kratkych_akci, na.rm = TRUE) + plot_annotation("Podíl vedoucích \ndle frekvence krátkých akcí kmene")
hlavni_data %>% plot_binarni_s_nejistotou("ma_vudcovskou_roli", frekvence_vicedennich_akci, na.rm = TRUE) + plot_annotation("Podíl vedoucích \ndle frekvence vícedenních akcí kmene")
```


# Roverští singles


# Vstup do roverského věku

Ifanka: Jak jsou na tom rádci u oddílů / u družin s aktivitou (jde mi asi hlavně o ty mladší) - jak často jezdí na akce, vzdělávačky, jednoduše jak jsou aktivní?

Přechod automaticky - znamená to “Bez rituálu?”

# Odchod z roverského věku

TODO: Problémy - jak se změnilo mezi lidmi, co “byli” a “jsou”

# Pracující / studující

# Rovering a středisko

# Nezařazeno

```{r}
plots$spokojenost_rs <- hlavni_data %>% plot_summary_mc(spokojenost_clenstvim_v_rs, "Spokojenost s členstvím ve společenství")
plots$spokojenost_rs
```

```{r}
set_theme_revizers()
plots$spokojenost_junak <- hlavni_data %>% plot_summary_mc(spokojenost_s_fungovanim_v_junaku, "Spokojenost s fungováním v Junáku\nJen bez roverske zkušenosti")

plots$spokojenost_junak
```

```{r}
plots$komunikace_existujici <- hlavni_data %>% plot_summary_mc(komunikacni_kanaly_existujici, "Kde bys nejraději sledoval\n informace o roveringu")
plots$komunikace_existujici
plots$komunikace_hypoteticke <- hlavni_data %>% plot_summary_mc(komunikacni_kanaly_hypoteticke, "Kde bys nejraději sledoval\n informace o roveringu (hypotetické)")
plots$komunikace_hypoteticke

```



```{r}
plots$role <- hlavni_data %>% plot_summary_mc(role_skauting, "Role ve skautingu")
plots$role
```


```{r}
plots$co_zazil <- hlavni_data %>% plot_summary_mc(co_zazil, "Co zažili ve skautingu")
plots$co_zazil
```

```{r}

plots$problemy_cleni <- hlavni_data %>% plot_summary_mc(problemy_roveringu, "Hlavní problémy roveringu \n jen členi společenství")

plots$problemy_cleni

```

```{r}
plots$problemy_necleni <- hlavni_data %>% plot_summary_mc(problemy_roveringu_stredisko, "Hlavní problémy roveringu\njen bez společenství")

plots$problemy_necleni
```


```{r}
if(any(!is.na(hlavni_data$problemy_roveringu) && !is.na(hlavni_data$problemy_roveringu_stredisko))) {
  stop("Problemy nejsou unikatni")
}
plots$problemy_all <- hlavni_data %>% mutate(problemy_roveringu_all = if_else(!is.na(problemy_roveringu), problemy_roveringu, 
                                                  problemy_roveringu_stredisko)) %>%
  plot_summary_mc(problemy_roveringu_all, "Hlavní problémy roveringu")

plots$problemy_all
```


```{r}
plots$co_zazil <- plot_summary_mc(hlavni_data, co_zazil)
plots$co_zazil
```

```{r}
plots$s_cim_spokojen <- plot_summary_mc(hlavni_data, s_cim_spokojen, title = "S čím jsi ve společenství spokojen")
plots$s_cim_spokojen



plots$s_cim_nespokojen <- plot_summary_mc(hlavni_data, s_cim_nespokojen, title = "S čím jsi ve společenství NEspokojen") 
plots$s_cim_nespokojen

```

```{r}
plots$sluzba <- plot_summary_mc(hlavni_data, sluzba, title = "Služba za poslední měsíc") 
plots$sluzba
```


```{r}
plots$oranizace_spolecenstvi <- plot_summary_mc(hlavni_data, organizace_spolecenstvi, title = "Organizace kmene")
plots$oranizace_spolecenstvi
```

```{r}
plots$vyroky_o_roveringu_zazil <- plot_summary_mc(hlavni_data, vyroky_o_roveringu_zazil, "Rovering, který jsem zažil 1") 
plots$vyroky_o_roveringu_zazil

plots$vyroky_o_roveringu_zazil_2 <- plot_summary_mc(hlavni_data, vyroky_o_roveringu_zazil_2, "Rovering, který jsem zažil 2") 
plots$vyroky_o_roveringu_zazil_2
```

```{r}
plots$vyroky_o_roveringu_stredisko <- plot_summary_mc(hlavni_data, vyroky_o_roveringu_stredisko, "O roverech v mém středisku platí")
plots$vyroky_o_roveringu_stredisko
```


```{r}
plots$fungovani_skautskeho_oddilu <- plot_summary_mc(hlavni_data, fungovani_skautskeho_oddilu, "Moje družina ve skautském věku") 
plots$fungovani_skautskeho_oddilu
```


```{r}
plots$co_pomaha_roveringu <- plot_summary_mc(hlavni_data, co_pomaha_roveringu, "Roveringu dle mé vlastní\nzkušenosti znatelně pomáhá:")
plots$co_pomaha_roveringu

```

```{r}
plots$proc_neni_rover <- plot_summary_mc(hlavni_data, proc_neni_rover, "Proč už nejsem v roverském společenství")
plots$proc_neni_rover

```

```{r}
plots$proc_nebyl_rover <- plot_summary_mc(hlavni_data, proc_nebyl_rover, "Proč jis nikdy nebyla\nsoučástí roverského společenství")
plots$proc_nebyl_rover

```

```{r}
plots$bez_zkusenosti_velke_akce <- plot_summary_mc(hlavni_data, bez_zkusenosti_velke_akce, "Účast na akcích\n(jen bez roverské zkušenosti)")
plots$bez_zkusenosti_velke_akce


```

```{r}
plots$spolecenstvi_registrace <- plot_summary_mc(hlavni_data, spolecenstvi_registrace)
plots$spolecenstvi_registrace


```



```{r}
plots$pocet_clenu_spolecenstvi <- plot_summary_mc(hlavni_data, pocet_clenu_spolecenstvi, order_by_podil = FALSE, invert_color_threshold =  0.03)
plots$pocet_clenu_spolecenstvi

```


```{r}
plots$bez_zkusenosti_setkavam_se_s_vrstevniky <- plot_summary_mc(hlavni_data, bez_zkusenosti_setkavam_se_s_vrstevniky, "Setkávání s vrstevníky \n  roveři mimo společenství", order_by_podil = FALSE, invert_color_threshold = 0.02)
plots$bez_zkusenosti_setkavam_se_s_vrstevniky

```

```{r}
plots$bez_zkusenosti_seberozvojovy_program <- plot_summary_mc(hlavni_data, bez_zkusenosti_seberozvojovy_program, "Seberozvojový program \n roveři mimo společenství", order_by_podil = FALSE, invert_color_threshold = 0.02)
plots$bez_zkusenosti_seberozvojovy_program
```


# Doplňky a kontroly


TODO: Diskrepance: role - “člen roverského společenství” a kategorie respondenta


```{r}
v_kmeni_od_14ti <- sum(datasety_wide$pouzitelne$let_v_kmeni > datasety_wide$pouzitelne$age - 14, na.rm = TRUE)
v_kmeni_od_13ti <- sum(datasety_wide$pouzitelne$let_v_kmeni > datasety_wide$pouzitelne$age - 13, na.rm = TRUE)
```

`r v_kmeni_od_14ti` respondentů bylo (dle svých odpovědí) v kmeni už ve 14ti letech, `r v_kmeni_od_13ti` dokonce ve 13ti. Otázka, jestli to není spíš znak, že to lidé vyplňovali špatně. (V hlavních datech tyto ignoruji)


```{r}
hlavni_data %>% filter(!is.na(let_v_kmeni)) %>%
  group_by(let_v_kmeni, age) %>%
  summarise(pocet = n()) %>%
  ggplot(aes(x = let_v_kmeni, y = age, fill = pocet)) + geom_raster() + 
  scale_fill_revize(discrete = FALSE)  + vodorovne_popisky_x
```


Věk vstupu do Junáka se moc neliší napříč věkovými skupinami.

```{r}
data_vstupy %>% filter(!is.na(vek_vstupu_do_junaka)) %>%
  group_by(vek_vstupu_do_junaka, age) %>%
  summarise(pocet = n()) %>%
  group_by(age) %>%
  mutate(podil_ve_vekove_skupine = pocet / sum(pocet)) %>%
  ggplot(aes(x = vek_vstupu_do_junaka, y = age, fill = podil_ve_vekove_skupine)) + geom_raster() + 
  scale_fill_revize(discrete = FALSE)  + vodorovne_popisky_x
```


```{r}
data_vstupy %>% filter(!is.na(vek_vstupu_do_kmene)) %>%
  group_by(vek_vstupu_do_kmene, age) %>%
  summarise(pocet = n()) %>%
  group_by(age) %>%
  mutate(podil_ve_vekove_skupine = pocet / sum(pocet)) %>%
  ggplot(aes(x = vek_vstupu_do_kmene, y = age, fill = podil_ve_vekove_skupine)) + geom_raster() + 
  scale_fill_revize(discrete = FALSE)  + vodorovne_popisky_x

```


Rozložení věku vstupu do Junáka vychází podobně jako z registrace.
Pozn. ti u kterých vycházel věk vstupu do Junáka menší než 5 byli vyjmuti.

```{r}
plots$vek_vstupu_do_junaka <- data_vstupy %>% filter(!is.na(vek_vstupu_do_junaka)) %>%
  ggplot(aes(x = vek_vstupu_do_junaka)) + geom_freqpoly(binwidth = 1) + vodorovne_popisky_x
plots$vek_vstupu_do_junaka
```


```{r save_plots}
save_list_of_plots(plots,"stav_roveringu")
```

